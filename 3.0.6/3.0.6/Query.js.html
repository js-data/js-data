<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <title>Query.js - Documentation</title>


    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="wrap">

    <input type="text" id="nav-search" placeholder="Search" />

    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Collection.html">Collection</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Collection.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Collection.html#add">add</a></li><li data-type='method' style='display: none;'><a href="Collection.html#afterRemove">afterRemove</a></li><li data-type='method' style='display: none;'><a href="Collection.html#afterRemoveAll">afterRemoveAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#beforeAdd">beforeAdd</a></li><li data-type='method' style='display: none;'><a href="Collection.html#beforeRemove">beforeRemove</a></li><li data-type='method' style='display: none;'><a href="Collection.html#beforeRemoveAll">beforeRemoveAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#between">between</a></li><li data-type='method' style='display: none;'><a href="Collection.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="Collection.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Collection.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Collection.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="Collection.html#forEach">forEach</a></li><li data-type='method' style='display: none;'><a href="Collection.html#get">get</a></li><li data-type='method' style='display: none;'><a href="Collection.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#getIndex">getIndex</a></li><li data-type='method' style='display: none;'><a href="Collection.html#limit">limit</a></li><li data-type='method' style='display: none;'><a href="Collection.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Collection.html#map">map</a></li><li data-type='method' style='display: none;'><a href="Collection.html#mapCall">mapCall</a></li><li data-type='method' style='display: none;'><a href="Collection.html#method">method</a></li><li data-type='method' style='display: none;'><a href="Collection.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Collection.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Collection.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="Collection.html#query">query</a></li><li data-type='method' style='display: none;'><a href="Collection.html#recordId">recordId</a></li><li data-type='method' style='display: none;'><a href="Collection.html#reduce">reduce</a></li><li data-type='method' style='display: none;'><a href="Collection.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="Collection.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#skip">skip</a></li><li data-type='method' style='display: none;'><a href="Collection.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Collection.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="Collection.html#updateIndex">updateIndex</a></li><li data-type='method' style='display: none;'><a href="Collection.html#updateIndexes">updateIndexes</a></li></ul></li><li><a href="Component.html">Component</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Component.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Component.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Component.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Component.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Component.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Component.html#on">on</a></li></ul></li><li><a href="Container.html">Container</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Container.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Container.html#as">as</a></li><li data-type='method' style='display: none;'><a href="Container.html#count">count</a></li><li data-type='method' style='display: none;'><a href="Container.html#create">create</a></li><li data-type='method' style='display: none;'><a href="Container.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="Container.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="Container.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Container.html#defineMapper">defineMapper</a></li><li data-type='method' style='display: none;'><a href="Container.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Container.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="Container.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Container.html#find">find</a></li><li data-type='method' style='display: none;'><a href="Container.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="Container.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="Container.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="Container.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="Container.html#getMapper">getMapper</a></li><li data-type='method' style='display: none;'><a href="Container.html#getMapperByName">getMapperByName</a></li><li data-type='method' style='display: none;'><a href="Container.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="Container.html#is">is</a></li><li data-type='method' style='display: none;'><a href="Container.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Container.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Container.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Container.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="Container.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="Container.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Container.html#update">update</a></li><li data-type='method' style='display: none;'><a href="Container.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="Container.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="Container.html#validate">validate</a></li></ul></li><li><a href="DataStore.html">DataStore</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DataStore.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#add">add</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#addToCache">addToCache</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#as">as</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#between">between</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cachedFind">cachedFind</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cachedFindAll">cachedFindAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cacheFind">cacheFind</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cacheFindAll">cacheFindAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#count">count</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#create">create</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#defineMapper">defineMapper</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#find">find</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#get">get</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getMapper">getMapper</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getMapperByName">getMapperByName</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#hashQuery">hashQuery</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#is">is</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#log">log</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#off">off</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#on">on</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#query">query</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#removeRelated">removeRelated</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#update">update</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#validate">validate</a></li></ul></li><li><a href="LinkedCollection.html">LinkedCollection</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LinkedCollection.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#add">add</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#afterRemove">afterRemove</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#afterRemoveAll">afterRemoveAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#beforeAdd">beforeAdd</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#beforeRemove">beforeRemove</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#beforeRemoveAll">beforeRemoveAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#between">between</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#forEach">forEach</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#get">get</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#getIndex">getIndex</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#limit">limit</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#log">log</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#map">map</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#mapCall">mapCall</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#method">method</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#off">off</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#on">on</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#query">query</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#recordId">recordId</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#reduce">reduce</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#skip">skip</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#updateIndex">updateIndex</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#updateIndexes">updateIndexes</a></li></ul></li><li><a href="Mapper.html">Mapper</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Mapper.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterCount">afterCount</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterCreate">afterCreate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterCreateMany">afterCreateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterDestroy">afterDestroy</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterDestroyAll">afterDestroyAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterFind">afterFind</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterFindAll">afterFindAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterSum">afterSum</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterUpdate">afterUpdate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterUpdateAll">afterUpdateAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterUpdateMany">afterUpdateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeCount">beforeCount</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeCreate">beforeCreate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeCreateMany">beforeCreateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeDestroy">beforeDestroy</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeDestroyAll">beforeDestroyAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeFind">beforeFind</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeFindAll">beforeFindAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeSum">beforeSum</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeUpdate">beforeUpdate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeUpdateAll">beforeUpdateAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeUpdateMany">beforeUpdateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#belongsTo">belongsTo</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#count">count</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#create">create</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#createInstance">createInstance</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#crud">crud</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#find">find</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#hasMany">hasMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#hasOne">hasOne</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#is">is</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#update">update</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#wrap">wrap</a></li></ul></li><li><a href="Query.html">Query</a><ul class='members'><li data-type='member' style='display: none;'><a href="Query.html#.ops">ops</a></li><li data-type='member' style='display: none;'><a href="Query.html#collection">collection</a></li><li data-type='member' style='display: none;'><a href="Query.html#data">data</a></li><li data-type='member' style='display: none;'><a href="Query.html#debug">debug</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Query.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Query.html#between">between</a></li><li data-type='method' style='display: none;'><a href="Query.html#compare">compare</a></li><li data-type='method' style='display: none;'><a href="Query.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Query.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Query.html#evaluate">evaluate</a></li><li data-type='method' style='display: none;'><a href="Query.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="Query.html#forEach">forEach</a></li><li data-type='method' style='display: none;'><a href="Query.html#get">get</a></li><li data-type='method' style='display: none;'><a href="Query.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="Query.html#getData">getData</a></li><li data-type='method' style='display: none;'><a href="Query.html#like">like</a></li><li data-type='method' style='display: none;'><a href="Query.html#limit">limit</a></li><li data-type='method' style='display: none;'><a href="Query.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Query.html#map">map</a></li><li data-type='method' style='display: none;'><a href="Query.html#mapCall">mapCall</a></li><li data-type='method' style='display: none;'><a href="Query.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Query.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Query.html#run">run</a></li><li data-type='method' style='display: none;'><a href="Query.html#skip">skip</a></li></ul></li><li><a href="Record.html">Record</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Record.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Record.html#_mapper">_mapper</a></li><li data-type='method' style='display: none;'><a href="Record.html#afterLoadRelations">afterLoadRelations</a></li><li data-type='method' style='display: none;'><a href="Record.html#beforeLoadRelations">beforeLoadRelations</a></li><li data-type='method' style='display: none;'><a href="Record.html#changeHistory">changeHistory</a></li><li data-type='method' style='display: none;'><a href="Record.html#changes">changes</a></li><li data-type='method' style='display: none;'><a href="Record.html#commit">commit</a></li><li data-type='method' style='display: none;'><a href="Record.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Record.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Record.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Record.html#get">get</a></li><li data-type='method' style='display: none;'><a href="Record.html#hasChanges">hasChanges</a></li><li data-type='method' style='display: none;'><a href="Record.html#isNew">isNew</a></li><li data-type='method' style='display: none;'><a href="Record.html#isValid">isValid</a></li><li data-type='method' style='display: none;'><a href="Record.html#loadRelations">loadRelations</a></li><li data-type='method' style='display: none;'><a href="Record.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Record.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Record.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Record.html#previous">previous</a></li><li data-type='method' style='display: none;'><a href="Record.html#revert">revert</a></li><li data-type='method' style='display: none;'><a href="Record.html#save">save</a></li><li data-type='method' style='display: none;'><a href="Record.html#set">set</a></li><li data-type='method' style='display: none;'><a href="Record.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Record.html#unset">unset</a></li><li data-type='method' style='display: none;'><a href="Record.html#validate">validate</a></li></ul></li><li><a href="Schema.html">Schema</a><ul class='members'><li data-type='member' style='display: none;'><a href="Schema.html#.ANY_OPS">ANY_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.ARRAY_OPS">ARRAY_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.NUMERIC_OPS">NUMERIC_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.OBJECT_OPS">OBJECT_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.STRING_OPS">STRING_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.typeGroupValidators">typeGroupValidators</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.types">types</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.validationKeywords">validationKeywords</a></li><li data-type='member' style='display: none;'><a href="Schema.html#debug">debug</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Schema.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Schema.html#.validate">validate</a></li><li data-type='method' style='display: none;'><a href="Schema.html#apply">apply</a></li><li data-type='method' style='display: none;'><a href="Schema.html#applyDefaults">applyDefaults</a></li><li data-type='method' style='display: none;'><a href="Schema.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Schema.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Schema.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Schema.html#makeDescriptor">makeDescriptor</a></li><li data-type='method' style='display: none;'><a href="Schema.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Schema.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Schema.html#pick">pick</a></li><li data-type='method' style='display: none;'><a href="Schema.html#validate">validate</a></li></ul></li><li><a href="Settable.html">Settable</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Settable.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Settable.html#_get">_get</a></li></ul></li><li><a href="SimpleStore.html">SimpleStore</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SimpleStore.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#add">add</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#addToCache">addToCache</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#as">as</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#between">between</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cachedFind">cachedFind</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cachedFindAll">cachedFindAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cacheFind">cacheFind</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cacheFindAll">cacheFindAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#count">count</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#create">create</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#defineMapper">defineMapper</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#find">find</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#get">get</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getMapper">getMapper</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getMapperByName">getMapperByName</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#hashQuery">hashQuery</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#is">is</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#log">log</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#off">off</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#on">on</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#query">query</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#removeRelated">removeRelated</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#update">update</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#validate">validate</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-js-data.html">js-data</a><ul class='members'><li data-type='member' style='display: none;'><a href="module-js-data.html#.Collection">Collection</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Component">Component</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Container">Container</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.DataStore">DataStore</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Index">Index</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.LinkedCollection">LinkedCollection</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Mapper">Mapper</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Query">Query</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Record">Record</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Schema">Schema</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Settable">Settable</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.SimpleStore">SimpleStore</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.utils">utils</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.version">version</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="module-js-data.html#.belongsTo">belongsTo</a></li><li data-type='method' style='display: none;'><a href="module-js-data.html#.hasMany">hasMany</a></li><li data-type='method' style='display: none;'><a href="module-js-data.html#.hasOne">hasOne</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="Collection.html#event:add">add</a></li><li><a href="Collection.html#event:change">change</a></li><li><a href="Collection.html#event:remove">remove</a></li><li><a href="Container.html#event:afterCreate">afterCreate</a></li><li><a href="Container.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="Container.html#event:afterDestroy">afterDestroy</a></li><li><a href="Container.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="Container.html#event:afterFind">afterFind</a></li><li><a href="Container.html#event:afterFindAll">afterFindAll</a></li><li><a href="Container.html#event:afterUpdate">afterUpdate</a></li><li><a href="Container.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="Container.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="Container.html#event:beforeCreate">beforeCreate</a></li><li><a href="Container.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="Container.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="Container.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="Container.html#event:beforeFind">beforeFind</a></li><li><a href="Container.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="Container.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="Container.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="Container.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="DataStore.html#event:add">add</a></li><li><a href="DataStore.html#event:afterCreate">afterCreate</a></li><li><a href="DataStore.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="DataStore.html#event:afterDestroy">afterDestroy</a></li><li><a href="DataStore.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="DataStore.html#event:afterFind">afterFind</a></li><li><a href="DataStore.html#event:afterFindAll">afterFindAll</a></li><li><a href="DataStore.html#event:afterUpdate">afterUpdate</a></li><li><a href="DataStore.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="DataStore.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="DataStore.html#event:beforeCreate">beforeCreate</a></li><li><a href="DataStore.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="DataStore.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="DataStore.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="DataStore.html#event:beforeFind">beforeFind</a></li><li><a href="DataStore.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="DataStore.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="DataStore.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="DataStore.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="DataStore.html#event:change">change</a></li><li><a href="DataStore.html#event:remove">remove</a></li><li><a href="LinkedCollection.html#event:add">add</a></li><li><a href="LinkedCollection.html#event:change">change</a></li><li><a href="LinkedCollection.html#event:remove">remove</a></li><li><a href="Mapper.html#event:afterCreate">afterCreate</a></li><li><a href="Mapper.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="Mapper.html#event:afterDestroy">afterDestroy</a></li><li><a href="Mapper.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="Mapper.html#event:afterFind">afterFind</a></li><li><a href="Mapper.html#event:afterFindAll">afterFindAll</a></li><li><a href="Mapper.html#event:afterUpdate">afterUpdate</a></li><li><a href="Mapper.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="Mapper.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="Mapper.html#event:beforeCreate">beforeCreate</a></li><li><a href="Mapper.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="Mapper.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="Mapper.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="Mapper.html#event:beforeFind">beforeFind</a></li><li><a href="Mapper.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="Mapper.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="Mapper.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="Mapper.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="Record.html#event:change">change</a></li><li><a href="SimpleStore.html#event:add">add</a></li><li><a href="SimpleStore.html#event:afterCreate">afterCreate</a></li><li><a href="SimpleStore.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="SimpleStore.html#event:afterDestroy">afterDestroy</a></li><li><a href="SimpleStore.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="SimpleStore.html#event:afterFind">afterFind</a></li><li><a href="SimpleStore.html#event:afterFindAll">afterFindAll</a></li><li><a href="SimpleStore.html#event:afterUpdate">afterUpdate</a></li><li><a href="SimpleStore.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="SimpleStore.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="SimpleStore.html#event:beforeCreate">beforeCreate</a></li><li><a href="SimpleStore.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="SimpleStore.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="SimpleStore.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="SimpleStore.html#event:beforeFind">beforeFind</a></li><li><a href="SimpleStore.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="SimpleStore.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="SimpleStore.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="SimpleStore.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="SimpleStore.html#event:change">change</a></li><li><a href="SimpleStore.html#event:remove">remove</a></li></ul><h3>Namespaces</h3><ul><li><a href="query_.html">query</a><ul class='members'><li data-type='member' style='display: none;'><a href="query_.html#.limit">limit</a></li><li data-type='member' style='display: none;'><a href="query_.html#.offset">offset</a></li><li data-type='member' style='display: none;'><a href="query_.html#.orderBy">orderBy</a></li><li data-type='member' style='display: none;'><a href="query_.html#.where">where</a></li></ul></li><li><a href="utils.html">utils</a><ul class='members'><li data-type='member' style='display: none;'><a href="utils.html#.Promise">Promise</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="utils.html#.addHiddenPropsToTarget">addHiddenPropsToTarget</a></li><li data-type='method' style='display: none;'><a href="utils.html#.areDifferent">areDifferent</a></li><li data-type='method' style='display: none;'><a href="utils.html#.classCallCheck">classCallCheck</a></li><li data-type='method' style='display: none;'><a href="utils.html#.copy">copy</a></li><li data-type='method' style='display: none;'><a href="utils.html#.deepEqual">deepEqual</a></li><li data-type='method' style='display: none;'><a href="utils.html#.deepFillIn">deepFillIn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.deepMixIn">deepMixIn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.diffObjects">diffObjects</a></li><li data-type='method' style='display: none;'><a href="utils.html#.equal">equal</a></li><li data-type='method' style='display: none;'><a href="utils.html#.err">err</a></li><li data-type='method' style='display: none;'><a href="utils.html#.eventify">eventify</a></li><li data-type='method' style='display: none;'><a href="utils.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="utils.html#.fillIn">fillIn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.findIndex">findIndex</a></li><li data-type='method' style='display: none;'><a href="utils.html#.forEachRelation">forEachRelation</a></li><li data-type='method' style='display: none;'><a href="utils.html#.forOwn">forOwn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.fromJson">fromJson</a></li><li data-type='method' style='display: none;'><a href="utils.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="utils.html#.getSuper">getSuper</a></li><li data-type='method' style='display: none;'><a href="utils.html#.intersection">intersection</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isArray">isArray</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isBlacklisted">isBlacklisted</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isBoolean">isBoolean</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isDate">isDate</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isFunction">isFunction</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isInteger">isInteger</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isNull">isNull</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isNumber">isNumber</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isObject">isObject</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isRegExp">isRegExp</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isSorN">isSorN</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isString">isString</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isUndefined">isUndefined</a></li><li data-type='method' style='display: none;'><a href="utils.html#.logify">logify</a></li><li data-type='method' style='display: none;'><a href="utils.html#.noDupeAdd">noDupeAdd</a></li><li data-type='method' style='display: none;'><a href="utils.html#.omit">omit</a></li><li data-type='method' style='display: none;'><a href="utils.html#.pick">pick</a></li><li data-type='method' style='display: none;'><a href="utils.html#.plainCopy">plainCopy</a></li><li data-type='method' style='display: none;'><a href="utils.html#.reject">reject</a></li><li data-type='method' style='display: none;'><a href="utils.html#.remove">remove</a></li><li data-type='method' style='display: none;'><a href="utils.html#.resolve">resolve</a></li><li data-type='method' style='display: none;'><a href="utils.html#.set">set</a></li><li data-type='method' style='display: none;'><a href="utils.html#.toJson">toJson</a></li><li data-type='method' style='display: none;'><a href="utils.html#.unset">unset</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#_createOrAssignChildRecordIfRequired">_createOrAssignChildRecordIfRequired</a></li><li><a href="global.html#_createParentRecordIfRequired">_createParentRecordIfRequired</a></li></ul>
</nav>

<div id="main">

    <h1 class="page-title">Query.js</h1>







    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import utils from './utils'
import Component from './Component'

const DOMAIN = 'Query'
const INDEX_ERR = 'Index inaccessible after first operation'

// Reserved words used by JSData's Query Syntax
const reserved = {
  limit: '',
  offset: '',
  orderBy: '',
  skip: '',
  sort: '',
  where: ''
}

// Used by our JavaScript implementation of the LIKE operator
const escapeRegExp = /([.*+?^=!:${}()|[\]/\\])/g
const percentRegExp = /%/g
const underscoreRegExp = /_/g
const escape = function (pattern) {
  return pattern.replace(escapeRegExp, '\\$1')
}

/**
 * A class used by the {@link Collection} class to build queries to be executed
 * against the collection's data. An instance of `Query` is returned by
 * {@link Collection#query}. Query instances are typically short-lived, and you
 * shouldn't have to create them yourself. Just use {@link Collection#query}.
 *
 * ```javascript
 * import { Query } from 'js-data';
 * ```
 *
 * @example &lt;caption>Query intro&lt;/caption>
 * const JSData = require('js-data');
 * const { DataStore } = JSData;
 * console.log('Using JSData v' + JSData.version.full);
 *
 * const store = new DataStore();
 * store.defineMapper('post');
 * const posts = [
 *   { author: 'John', age: 30, status: 'published', id: 1 },
 *   { author: 'Sally', age: 31, status: 'draft', id: 2 },
 *   { author: 'Mike', age: 32, status: 'draft', id: 3 },
 *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
 *   { author: 'Adam', age: 33, status: 'draft', id: 5 }
 * ]
 * store.add('post', posts);
 * const drafts = store.query('post').filter({ status: 'draft' }).limit(2).run();
 * console.log(drafts);
 *
 * @class Query
 * @extends Component
 * @param {Collection} collection The collection on which this query operates.
 * @since 3.0.0
 */
function Query (collection) {
  utils.classCallCheck(this, Query)

  /**
   * The {@link Collection} on which this query operates.
   *
   * @name Query#collection
   * @since 3.0.0
   * @type {Collection}
   */
  this.collection = collection

  /**
   * The current data result of this query.
   *
   * @name Query#data
   * @since 3.0.0
   * @type {Array}
   */
  this.data = null
}

export default Component.extend({
  constructor: Query,

  _applyWhereFromObject (where) {
    const fields = []
    const ops = []
    const predicates = []
    utils.forOwn(where, (clause, field) => {
      if (!utils.isObject(clause)) {
        clause = {
          '==': clause
        }
      }
      utils.forOwn(clause, (expr, op) => {
        fields.push(field)
        ops.push(op)
        predicates.push(expr)
      })
    })
    return {
      fields,
      ops,
      predicates
    }
  },

  _applyWhereFromArray (where) {
    const groups = []
    where.forEach((_where, i) => {
      if (utils.isString(_where)) {
        return
      }
      const prev = where[i - 1]
      const parser = utils.isArray(_where) ? this._applyWhereFromArray : this._applyWhereFromObject
      const group = parser.call(this, _where)
      if (prev === 'or') {
        group.isOr = true
      }
      groups.push(group)
    })
    groups.isArray = true
    return groups
  },

  _testObjectGroup (keep, first, group, item) {
    let i
    const fields = group.fields
    const ops = group.ops
    const predicates = group.predicates
    const len = ops.length
    for (i = 0; i &lt; len; i++) {
      let op = ops[i]
      const isOr = op.charAt(0) === '|'
      op = isOr ? op.substr(1) : op
      const expr = this.evaluate(utils.get(item, fields[i]), op, predicates[i])
      if (expr !== undefined) {
        keep = first ? expr : (isOr ? keep || expr : keep &amp;&amp; expr)
      }
      first = false
    }
    return { keep, first }
  },

  _testArrayGroup (keep, first, groups, item) {
    let i
    const len = groups.length
    for (i = 0; i &lt; len; i++) {
      const group = groups[i]
      const parser = group.isArray ? this._testArrayGroup : this._testObjectGroup
      const result = parser.call(this, true, true, group, item)
      if (groups[i - 1]) {
        if (group.isOr) {
          keep = keep || result.keep
        } else {
          keep = keep &amp;&amp; result.keep
        }
      } else {
        keep = result.keep
      }
      first = result.first
    }
    return { keep, first }
  },

  /**
   * Find all entities between two boundaries.
   *
   * @example &lt;caption>Get the users ages 18 to 30.&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('user');
   * const users = [
   *   { name: 'Peter', age: 25, id: 1 },
   *   { name: 'Jim', age: 19, id: 2 },
   *   { name: 'Mike', age: 17, id: 3 },
   *   { name: 'Alan', age: 29, id: 4 },
   *   { name: 'Katie', age: 33, id: 5 }
   * ];
   * store.add('user', users)
   * const filteredUsers = store
   *   .query('user')
   *   .between(18, 30, { index: 'age' })
   *   .run();
   * console.log(filteredUsers);
   *
   * @example &lt;caption>Same as above.&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('user');
   * const users = [
   *   { name: 'Peter', age: 25, id: 1 },
   *   { name: 'Jim', age: 19, id: 2 },
   *   { name: 'Mike', age: 17, id: 3 },
   *   { name: 'Alan', age: 29, id: 4 },
   *   { name: 'Katie', age: 33, id: 5 }
   * ];
   * store.add('user', users)
   * const filteredUsers = store
   *   .query('user')
   *   .between([18], [30], { index: 'age' })
   *   .run();
   * console.log(filteredUsers);
   *
   * @method Query#between
   * @param {array} leftKeys Keys defining the left boundary.
   * @param {array} rightKeys Keys defining the right boundary.
   * @param {object} [opts] Configuration options.
   * @param {string} [opts.index] Name of the secondary index to use in the
   * query. If no index is specified, the main index is used.
   * @param {boolean} [opts.leftInclusive=true] Whether to include entities
   * on the left boundary.
   * @param {boolean} [opts.rightInclusive=false] Whether to include entities
   * on the left boundary.
   * @param {boolean} [opts.limit] Limit the result to a certain number.
   * @param {boolean} [opts.offset] The number of resulting entities to skip.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  between (leftKeys, rightKeys, opts) {
    opts || (opts = {})
    if (this.data) {
      throw utils.err(`${DOMAIN}#between`)(500, 'Cannot access index')
    }
    this.data = this.collection.getIndex(opts.index).between(leftKeys, rightKeys, opts)
    return this
  },

  /**
   * The comparison function used by the {@link Query} class.
   *
   * @method Query#compare
   * @param {array} orderBy An orderBy clause used for sorting and sub-sorting.
   * @param {number} index The index of the current orderBy clause being used.
   * @param {*} a The first item in the comparison.
   * @param {*} b The second item in the comparison.
   * @returns {number} -1 if `b` should preceed `a`. 0 if `a` and `b` are equal.
   * 1 if `a` should preceed `b`.
   * @since 3.0.0
   */
  compare (orderBy, index, a, b) {
    const def = orderBy[index]
    let cA = utils.get(a, def[0])
    let cB = utils.get(b, def[0])
    if (cA &amp;&amp; utils.isString(cA)) {
      cA = cA.toUpperCase()
    }
    if (cB &amp;&amp; utils.isString(cB)) {
      cB = cB.toUpperCase()
    }
    if (a === undefined) {
      a = null
    }
    if (b === undefined) {
      b = null
    }
    if (def[1].toUpperCase() === 'DESC') {
      const temp = cB
      cB = cA
      cA = temp
    }
    if (cA &lt; cB) {
      return -1
    } else if (cA > cB) {
      return 1
    } else {
      if (index &lt; orderBy.length - 1) {
        return this.compare(orderBy, index + 1, a, b)
      } else {
        return 0
      }
    }
  },

  /**
   * Predicate evaluation function used by the {@link Query} class.
   *
   * @method Query#evaluate
   * @param {*} value The value to evaluate.
   * @param {string} op The operator to use in this evaluation.
   * @param {*} predicate The predicate to use in this evaluation.
   * @returns {boolean} Whether the value passed the evaluation or not.
   * @since 3.0.0
   */
  evaluate (value, op, predicate) {
    const ops = this.constructor.ops
    if (ops[op]) {
      return ops[op](value, predicate)
    }
    if (op.indexOf('like') === 0) {
      return this.like(predicate, op.substr(4)).exec(value) !== null
    } else if (op.indexOf('notLike') === 0) {
      return this.like(predicate, op.substr(7)).exec(value) === null
    }
  },

  /**
   * Find the record or records that match the provided query or are accepted by
   * the provided filter function.
   *
   * @example &lt;caption>Get the draft posts by authors younger than 30&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('post')
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'published', id: 2 },
   *   { author: 'Mike', age: 32, status: 'draft', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'published', id: 5 }
   *   { author: 'Peter', age: 25, status: 'deleted', id: 6 },
   *   { author: 'Sally', age: 21, status: 'draft', id: 7 },
   *   { author: 'Jim', age: 27, status: 'draft', id: 8 },
   *   { author: 'Jim', age: 27, status: 'published', id: 9 },
   *   { author: 'Jason', age: 55, status: 'published', id: 10 }
   * ];
   * store.add('post', posts);
   * const results = store
   *   .query('post')
   *   .filter({
   *     where: {
   *       status: {
   *         '==': 'draft'
   *       },
   *       age: {
   *         '&lt;': 30
   *       }
   *     }
   *   })
   *   .run();
   * console.log(results);
   *
   * @example &lt;caption>Use a custom filter function&lt;/caption>
   * const posts = query
   *   .filter(function (post) {
   *     return post.isReady();
   *   })
   *   .run();
   *
   * @method Query#filter
   * @param {(Object|Function)} [queryOrFn={}] Selection query or filter
   * function.
   * @param {Function} [thisArg] Context to which to bind `queryOrFn` if
   * `queryOrFn` is a function.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  filter (query, thisArg) {
    /**
     * Selection query as defined by JSData's [Query Syntax][querysyntax].
     *
     * [querysyntax]: http://www.js-data.io/v3.0/docs/query-syntax
     *
     * @example &lt;caption>Empty "findAll" query&lt;/caption>
     * const JSData = require('js-data');
     * const { DataStore } = JSData;
     * console.log('Using JSData v' + JSData.version.full);
     *
     * const store = new DataStore();
     * store.defineMapper('post')
     * store.findAll('post').then((posts) => {
     *   console.log(posts); // [...]
     * });
     *
     * @example &lt;caption>Empty "filter" query&lt;/caption>
     * const JSData = require('js-data');
     * const { DataStore } = JSData;
     * console.log('Using JSData v' + JSData.version.full);
     *
     * const store = new DataStore();
     * store.defineMapper('post');
     * const posts = store.filter('post');
     * console.log(posts); // [...]
     *
     * @example &lt;caption>Complex "filter" query&lt;/caption>
     * const JSData = require('js-data');
     * const { DataStore } = JSData;
     * console.log('Using JSData v' + JSData.version.full);
     *
     * const store = new DataStore();
     * const PAGE_SIZE = 2;
     * let currentPage = 3;
     *
     * store.defineMapper('post');
     * const posts = [
     *   { author: 'John', age: 30, status: 'published', id: 1 },
     *   { author: 'Sally', age: 31, status: 'published', id: 2 },
     *   { author: 'Mike', age: 32, status: 'draft', id: 3 },
     *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
     *   { author: 'Adam', age: 33, status: 'published', id: 5 }
     *   { author: 'Peter', age: 25, status: 'deleted', id: 6 },
     *   { author: 'Sally', age: 21, status: 'draft', id: 7 },
     *   { author: 'Jim', age: 27, status: 'draft', id: 8 },
     *   { author: 'Jim', age: 27, status: 'published', id: 9 },
     *   { author: 'Jason', age: 55, status: 'published', id: 10 }
     * ];
     * store.add('post', posts);
     * // Retrieve a filtered page of blog posts
     * // Would typically replace filter with findAll
     * const results = store.filter('post', {
     *   where: {
     *     status: {
     *       // WHERE status = 'published'
     *       '==': 'published'
     *     },
     *     author: {
     *       // AND author IN ('bob', 'alice')
     *       'in': ['bob', 'alice'],
     *       // OR author IN ('karen')
     *       '|in': ['karen']
     *     }
     *   },
     *   orderBy: [
     *     // ORDER BY date_published DESC,
     *     ['date_published', 'DESC'],
     *     // ORDER BY title ASC
     *     ['title', 'ASC']
     *   ],
     *   // LIMIT 2
     *   limit: PAGE_SIZE,
     *   // SKIP 4
     *   offset: PAGE_SIZE * (currentPage - 1)
     * });
     * console.log(results);
     *
     * @namespace query
     * @property {number} [limit] See {@link query.limit}.
     * @property {number} [offset] See {@link query.offset}.
     * @property {string|Array[]} [orderBy] See {@link query.orderBy}.
     * @property {number} [skip] Alias for {@link query.offset}.
     * @property {string|Array[]} [sort] Alias for {@link query.orderBy}.
     * @property {Object} [where] See {@link query.where}.
     * @since 3.0.0
     * @tutorial ["http://www.js-data.io/v3.0/docs/query-syntax","JSData's Query Syntax"]
     */
    query || (query = {})
    this.getData()
    if (utils.isObject(query)) {
      let where = {}

      /**
       * Filtering criteria. Records that do not meet this criteria will be exluded
       * from the result.
       *
       * @example &lt;caption>Return posts where author is at least 32 years old&lt;/caption>
       * const JSData = require('js-data');
       * const { DataStore } = JSData;
       * console.log('Using JSData v' + JSData.version.full);
       *
       * const store = new DataStore();
       * store.defineMapper('post')
       * const posts = [
       *   { author: 'John', age: 30, id: 5 },
       *   { author: 'Sally', age: 31, id: 6 },
       *   { author: 'Mike', age: 32, id: 7 },
       *   { author: 'Adam', age: 33, id: 8 },
       *   { author: 'Adam', age: 33, id: 9 }
       * ];
       * store.add('post', posts);
       * const results = store.filter('post', {
       *   where: {
       *     age: {
       *       '>=': 30
       *     }
       *   }
       * });
       * console.log(results);
       *
       * @name query.where
       * @type {Object}
       * @see http://www.js-data.io/v3.0/docs/query-syntax
       * @since 3.0.0
       */
      if (utils.isObject(query.where) || utils.isArray(query.where)) {
        where = query.where
      }
      utils.forOwn(query, function (value, key) {
        if (!(key in reserved) &amp;&amp; !(key in where)) {
          where[key] = {
            '==': value
          }
        }
      })
      let groups

      // Apply filter for each field
      if (utils.isObject(where) &amp;&amp; Object.keys(where).length !== 0) {
        groups = this._applyWhereFromArray([where])
      } else if (utils.isArray(where)) {
        groups = this._applyWhereFromArray(where)
      }

      if (groups) {
        this.data = this.data.filter((item, i) => this._testArrayGroup(true, true, groups, item).keep)
      }

      // Sort
      let orderBy = query.orderBy || query.sort

      if (utils.isString(orderBy)) {
        orderBy = [
          [orderBy, 'ASC']
        ]
      }
      if (!utils.isArray(orderBy)) {
        orderBy = null
      }

      /**
       * Determines how records should be ordered in the result.
       *
       * @example &lt;caption>Order posts by `author` then by `id` descending &lt;/caption>
       * const JSData = require('js-data');
       * const { DataStore } = JSData;
       * console.log('Using JSData v' + JSData.version.full);
       *
       * const store = new DataStore();
       * store.defineMapper('post')
       * const posts = [
       *   { author: 'John', age: 30, id: 5 },
       *   { author: 'Sally', age: 31, id: 6 },
       *   { author: 'Mike', age: 32, id: 7 },
       *   { author: 'Adam', age: 33, id: 8 },
       *   { author: 'Adam', age: 33, id: 9 }
       * ];
       * store.add('post', posts);
       * const results = store.filter('post', {
       *     orderBy:[['author','ASC'],['id','DESC']]
       * });
       * console.log(results);
       *
       * @name query.orderBy
       * @type {string|Array[]}
       * @see http://www.js-data.io/v3.0/docs/query-syntax
       * @since 3.0.0
       */
      if (orderBy) {
        const index = 0
        orderBy.forEach(function (def, i) {
          if (utils.isString(def)) {
            orderBy[i] = [def, 'ASC']
          }
        })
        this.data.sort((a, b) => this.compare(orderBy, index, a, b))
      }

      /**
       * Number of records to skip.
       *
       * @example &lt;caption>Retrieve the first "page" of blog posts using findAll&lt;/caption>
       * const JSData = require('js-data');
       * const { DataStore } = JSData;
       * console.log('Using JSData v' + JSData.version.full);
       *
       * const store = new DataStore();
       * store.defineMapper('post');
       * const PAGE_SIZE = 10;
       * let currentPage = 1;
       * store.findAll('post', {
       *   offset: PAGE_SIZE * (currentPage 1)
       *   limit: PAGE_SIZE
       * });
       *
       * @example &lt;caption>Retrieve the last "page" of blog posts using filter&lt;/caption>
       * const JSData = require('js-data');
       * const { DataStore } = JSData;
       * console.log('Using JSData v' + JSData.version.full);
       *
       * const store = new DataStore();
       *
       * const PAGE_SIZE = 5;
       * let currentPage = 2;
       * store.defineMapper('post');
       * const posts = [
       *   { author: 'John', age: 30, id: 1 },
       *   { author: 'Sally', age: 31, id: 2 },
       *   { author: 'Mike', age: 32, id: 3 },
       *   { author: 'Adam', age: 33, id: 4 },
       *   { author: 'Adam', age: 33, id: 5 },
       *   { author: 'Peter', age: 25, id: 6 },
       *   { author: 'Sally', age: 21, id: 7 },
       *   { author: 'Jim', age: 27, id: 8 },
       *   { author: 'Jim', age: 27, id: 9 },
       *   { author: 'Jason', age: 55, id: 10 }
       * ];
       * store.add('post', posts);
       * const results = store.filter('post', {
       *   offset: PAGE_SIZE * (currentPage 1)
       *   limit: PAGE_SIZE
       * });
       * console.log(results)
       *
       * @name query.offset
       * @type {number}
       * @see http://www.js-data.io/v3.0/docs/query-syntax
       * @since 3.0.0
       */
      if (utils.isNumber(query.skip)) {
        this.skip(query.skip)
      } else if (utils.isNumber(query.offset)) {
        this.skip(query.offset)
      }

      /**
       * Maximum number of records to retrieve.
       *
       * @example &lt;caption>Retrieve the first "page" of blog posts using findAll&lt;/caption>
       * const JSData = require('js-data');
       * const { DataStore } = JSData;
       * console.log('Using JSData v' + JSData.version.full);
       *
       * const store = new DataStore();
       * store.defineMapper('post');
       *
       * const PAGE_SIZE = 10
       * let currentPage = 1
       * store.findAll('post', {
       *   offset: PAGE_SIZE * (currentPage 1)
       *   limit: PAGE_SIZE
       * });
       *
       * @example &lt;caption>Retrieve the last "page" of blog posts using filter&lt;/caption>
       * const JSData = require('js-data');
       * const { DataStore } = JSData;
       * console.log('Using JSData v' + JSData.version.full);
       *
       * const store = new DataStore();
       *
       * const PAGE_SIZE = 5
       * let currentPage = 2
       * store.defineMapper('post')
       * const posts = [
       *   { author: 'John', age: 30, id: 1 },
       *   { author: 'Sally', age: 31, id: 2 },
       *   { author: 'Mike', age: 32, id: 3 },
       *   { author: 'Adam', age: 33, id: 4 },
       *   { author: 'Adam', age: 33, id: 5 },
       *   { author: 'Peter', age: 25, id: 6 },
       *   { author: 'Sally', age: 21, id: 7 },
       *   { author: 'Jim', age: 27, id: 8 },
       *   { author: 'Jim', age: 27, id: 9 },
       *   { author: 'Jason', age: 55, id: 10 }
       * ];
       * store.add('post', posts);
       * const results = store.filter('post', {
       *   offset: PAGE_SIZE * (currentPage 1)
       *   limit: PAGE_SIZE
       * });
       * console.log(results)
       *
       * @name query.limit
       * @type {number}
       * @see http://www.js-data.io/v3.0/docs/query-syntax
       * @since 3.0.0
       */
      if (utils.isNumber(query.limit)) {
        this.limit(query.limit)
      }
    } else if (utils.isFunction(query)) {
      this.data = this.data.filter(query, thisArg)
    }
    return this
  },

  /**
   * Iterate over all entities.
   *
   * @method Query#forEach
   * @param {Function} forEachFn Iteration function.
   * @param {*} [thisArg] Context to which to bind `forEachFn`.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  forEach (forEachFn, thisArg) {
    this.getData().forEach(forEachFn, thisArg)
    return this
  },

  /**
   * Find the entity or entities that match the provided key.
   *
   * @example &lt;caption>Get the entity whose primary key is 25.&lt;/caption>
   * const entities = query.get(25).run();
   *
   * @example &lt;caption>Same as above.&lt;/caption>
   * const entities = query.get([25]).run();
   *
   * @example &lt;caption>Get all users who are active and have the "admin" role.&lt;/caption>
   * const activeAdmins = query.get(['active', 'admin'], {
   *   index: 'activityAndRoles'
   * }).run();
   *
   * @example &lt;caption>Get all entities that match a certain weather condition.&lt;/caption>
   * const niceDays = query.get(['sunny', 'humid', 'calm'], {
   *   index: 'weatherConditions'
   * }).run();
   *
   * @method Query#get
   * @param {array} keyList Key(s) defining the entity to retrieve. If
   * `keyList` is not an array (i.e. for a single-value key), it will be
   * wrapped in an array.
   * @param {object} [opts] Configuration options.
   * @param {string} [opts.string] Name of the secondary index to use in the
   * query. If no index is specified, the main index is used.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  get (keyList, opts) {
    keyList || (keyList = [])
    opts || (opts = {})
    if (this.data) {
      throw utils.err(`${DOMAIN}#get`)(500, INDEX_ERR)
    }
    if (keyList &amp;&amp; !utils.isArray(keyList)) {
      keyList = [keyList]
    }
    if (!keyList.length) {
      this.getData()
      return this
    }
    this.data = this.collection.getIndex(opts.index).get(keyList)
    return this
  },

  /**
   * Find the entity or entities that match the provided keyLists.
   *
   * @example &lt;caption>Get the posts where "status" is "draft" or "inReview".&lt;/caption>
   * const posts = query.getAll('draft', 'inReview', { index: 'status' }).run();
   *
   * @example &lt;caption>Same as above.&lt;/caption>
   * const posts = query.getAll(['draft'], ['inReview'], { index: 'status' }).run();
   *
   * @method Query#getAll
   * @param {...Array} [keyList] Provide one or more keyLists, and all
   * entities matching each keyList will be retrieved. If no keyLists are
   * provided, all entities will be returned.
   * @param {object} [opts] Configuration options.
   * @param {string} [opts.index] Name of the secondary index to use in the
   * query. If no index is specified, the main index is used.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  getAll (...args) {
    let opts = {}
    if (this.data) {
      throw utils.err(`${DOMAIN}#getAll`)(500, INDEX_ERR)
    }
    if (!args.length || (args.length === 1 &amp;&amp; utils.isObject(args[0]))) {
      this.getData()
      return this
    } else if (args.length &amp;&amp; utils.isObject(args[args.length - 1])) {
      opts = args[args.length - 1]
      args.pop()
    }
    const collection = this.collection
    const index = collection.getIndex(opts.index)
    this.data = []
    args.forEach((keyList) => {
      this.data = this.data.concat(index.get(keyList))
    })
    return this
  },

  /**
   * Return the current data result of this query.
   *
   * @method Query#getData
   * @returns {Array} The data in this query.
   * @since 3.0.0
   */
  getData () {
    if (!this.data) {
      this.data = this.collection.index.getAll()
    }
    return this.data
  },

  /**
   * Implementation used by the `like` operator. Takes a pattern and flags and
   * returns a `RegExp` instance that can test strings.
   *
   * @method Query#like
   * @param {string} pattern Testing pattern.
   * @param {string} flags Flags for the regular expression.
   * @returns {RegExp} Regular expression for testing strings.
   * @since 3.0.0
   */
  like (pattern, flags) {
    return new RegExp(`^${(escape(pattern).replace(percentRegExp, '.*').replace(underscoreRegExp, '.'))}$`, flags)
  },

  /**
   * Limit the result.
   *
   * @example &lt;caption>Get only the first 2 posts.&lt;/caption>
   * const store = new JSData.DataStore();
   * store.defineMapper('post');
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'draft', id: 2 },
   *   { author: 'Mike', age: 32, status: 'draft', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'draft', id: 5 }
   * ];
   * store.add('post', posts);
   * const results = store.query('post').limit(2).run();
   * console.log(results);
   *
   * @method Query#limit
   * @param {number} num The maximum number of entities to keep in the result.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  limit (num) {
    if (!utils.isNumber(num)) {
      throw utils.err(`${DOMAIN}#limit`, 'num')(400, 'number', num)
    }
    const data = this.getData()
    this.data = data.slice(0, Math.min(data.length, num))
    return this
  },

  /**
   * Apply a mapping function to the result data.
   *
   * @example
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('user');
   * const users = [
   *   { name: 'Peter', age: 25, id: 1 },
   *   { name: 'Jim', age: 19, id: 2 },
   *   { name: 'Mike', age: 17, id: 3 },
   *   { name: 'Alan', age: 29, id: 4 },
   *   { name: 'Katie', age: 33, id: 5 }
   * ];
   * store.add('user', users);
   * const ages = store
   *   .query('user')
   *   .map(function (user) {
   *     return user.age;
   *   })
   *   .run();
   * console.log(ages);
   *
   * @method Query#map
   * @param {Function} mapFn Mapping function.
   * @param {*} [thisArg] Context to which to bind `mapFn`.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  map (mapFn, thisArg) {
    this.data = this.getData().map(mapFn, thisArg)
    return this
  },

  /**
   * Return the result of calling the specified function on each item in this
   * collection's main index.
   *
   * @example
   * const stringAges = UserCollection.query().mapCall('toString').run();
   *
   * @method Query#mapCall
   * @param {string} funcName Name of function to call
   * @parama {...*} [args] Remaining arguments to be passed to the function.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  mapCall (funcName, ...args) {
    this.data = this.getData().map(function (item) {
      return item[funcName](...args)
    })
    return this
  },

  /**
   * Complete the execution of the query and return the resulting data.
   *
   * @method Query#run
   * @returns {Array} The result of executing this query.
   * @since 3.0.0
   */
  run () {
    const data = this.data
    this.data = null
    return data
  },

  /**
   * Skip a number of results.
   *
   * @example &lt;caption>Get all but the first 2 posts.&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('post');
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'draft', id: 2 },
   *   { author: 'Mike', age: 32, status: 'draft', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'draft', id: 5 }
   * ];
   * store.add('post', posts);
   * const results = store.query('post').skip(2).run();
   * console.log(results);
   *
   * @method Query#skip
   * @param {number} num The number of entities to skip.
   * @returns {Query} A reference to itself for chaining.
   * @since 3.0.0
   */
  skip (num) {
    if (!utils.isNumber(num)) {
      throw utils.err(`${DOMAIN}#skip`, 'num')(400, 'number', num)
    }
    const data = this.getData()
    if (num &lt; data.length) {
      this.data = data.slice(num)
    } else {
      this.data = []
    }
    return this
  }
}, {
  /**
   * The filtering operators supported by {@link Query#filter}, and which are
   * implemented by adapters (for the most part).
   *
   * @example &lt;caption>Variant 1&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('post');
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'published', id: 2 },
   *   { author: 'Mike', age: 32, status: 'published', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'published', id: 5 }
   * ];
   * store.add('post', posts);
   * const publishedPosts = store.filter('post', {
   *   status: 'published',
   *   limit: 2
   * });
   * console.log(publishedPosts);
   *
   *
   * @example &lt;caption>Variant 2&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('post')
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'published', id: 2 },
   *   { author: 'Mike', age: 32, status: 'published', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'published', id: 5 }
   * ];
   * store.add('post', posts);
   * const publishedPosts = store.filter('post', {
   *   where: {
   *     status: {
   *       '==': 'published'
   *     }
   *   },
   *   limit: 2
   * });
   * console.log(publishedPosts);
   *
   * @example &lt;caption>Variant 3&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('post');
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'published', id: 2 },
   *   { author: 'Mike', age: 32, status: 'published', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'published', id: 5 }
   * ];
   * store.add('post', posts);
   * const publishedPosts = store
   *   .query('post')
   *   .filter({ status: 'published' })
   *   .limit(2)
   *   .run();
   * console.log(publishedPosts);
   *
   * @example &lt;caption>Variant 4&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('post');
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'published', id: 2 },
   *   { author: 'Mike', age: 32, status: 'published', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'published', id: 5 }
   * ];
   * store.add('post', posts);
   * const publishedPosts = store
   *   .query('post')
   *   .filter({
   *     where: {
   *       status: {
   *         '==': 'published'
   *       }
   *     }
   *   })
   *   .limit(2)
   *   .run();
   * console.log(publishedPosts);
   *
   * @example &lt;caption>Multiple operators&lt;/caption>
   * const JSData = require('js-data');
   * const { DataStore } = JSData;
   * console.log('Using JSData v' + JSData.version.full);
   *
   * const store = new DataStore();
   * store.defineMapper('post');
   * const posts = [
   *   { author: 'John', age: 30, status: 'published', id: 1 },
   *   { author: 'Sally', age: 31, status: 'published', id: 2 },
   *   { author: 'Mike', age: 32, status: 'published', id: 3 },
   *   { author: 'Adam', age: 33, status: 'deleted', id: 4 },
   *   { author: 'Adam', age: 33, status: 'published', id: 5 }
   * ];
   * store.add('post', posts);
   *
   * const myPublishedPosts = store.filter('post', {
   *   where: {
   *     status: {
   *       '==': 'published'
   *     },
   *     user_id: {
   *       '==': currentUser.id
   *     }
   *   }
   * });
   *
   * console.log(myPublishedPosts);
   *
   * @name Query.ops
   * @property {Function} == Equality operator.
   * @property {Function} != Inequality operator.
   * @property {Function} > Greater than operator.
   * @property {Function} >= Greater than (inclusive) operator.
   * @property {Function} &lt; Less than operator.
   * @property {Function} &lt;= Less than (inclusive) operator.
   * @property {Function} isectEmpty Operator that asserts that the intersection
   * between two arrays is empty.
   * @property {Function} isectNotEmpty Operator that asserts that the
   * intersection between two arrays is __not__ empty.
   * @property {Function} in Operator that asserts whether a value is in an
   * array.
   * @property {Function} notIn Operator that asserts whether a value is __not__
   * in an array.
   * @property {Function} contains Operator that asserts whether an array
   * contains a value.
   * @property {Function} notContains Operator that asserts whether an array
   * does __not__ contain a value.
   * @since 3.0.0
   * @type {Object}
   */
  ops: {
    '=': function (value, predicate) {
      return value == predicate // eslint-disable-line
    },
    '==': function (value, predicate) {
      return value == predicate // eslint-disable-line
    },
    '===': function (value, predicate) {
      return value === predicate
    },
    '!=': function (value, predicate) {
      return value != predicate // eslint-disable-line
    },
    '!==': function (value, predicate) {
      return value !== predicate
    },
    '>': function (value, predicate) {
      return value > predicate
    },
    '>=': function (value, predicate) {
      return value >= predicate
    },
    '&lt;': function (value, predicate) {
      return value &lt; predicate
    },
    '&lt;=': function (value, predicate) {
      return value &lt;= predicate
    },
    isectEmpty: function (value, predicate) {
      return !utils.intersection((value || []), (predicate || [])).length
    },
    isectNotEmpty: function (value, predicate) {
      return utils.intersection((value || []), (predicate || [])).length
    },
    in: function (value, predicate) {
      return predicate.indexOf(value) !== -1
    },
    notIn: function (value, predicate) {
      return predicate.indexOf(value) === -1
    },
    contains: function (value, predicate) {
      return (value || []).indexOf(predicate) !== -1
    },
    notContains: function (value, predicate) {
      return (value || []).indexOf(predicate) === -1
    }
  }
})

/**
 * Create a subclass of this Query:
 * @example &lt;caption>Query.extend&lt;/caption>
 * const JSData = require('js-data');
 * const { Query } = JSData;
 * console.log('Using JSData v' + JSData.version.full);
 *
 * // Extend the class using ES2015 class syntax.
 * class CustomQueryClass extends Query {
 *   foo () { return 'bar'; }
 *   static beep () { return 'boop'; }
 * }
 * const customQuery = new CustomQueryClass();
 * console.log(customQuery.foo());
 * console.log(CustomQueryClass.beep());
 *
 * // Extend the class using alternate method.
 * const OtherQueryClass = Query.extend({
 *   foo () { return 'bar'; }
 * }, {
 *   beep () { return 'boop'; }
 * });
 * const otherQuery = new OtherQueryClass();
 * console.log(otherQuery.foo());
 * console.log(OtherQueryClass.beep());
 *
 * // Extend the class, providing a custom constructor.
 * function AnotherQueryClass (collection) {
 *   Query.call(this, collection);
 *   this.created_at = new Date().getTime();
 * }
 * Query.extend({
 *   constructor: AnotherQueryClass,
 *   foo () { return 'bar'; }
 * }, {
 *   beep () { return 'boop'; }
 * });
 * const anotherQuery = new AnotherQueryClass();
 * console.log(anotherQuery.created_at);
 * console.log(anotherQuery.foo());
 * console.log(AnotherQueryClass.beep());
 *
 * @method Query.extend
 * @param {object} [props={}] Properties to add to the prototype of the
 * subclass.
 * @param {object} [props.constructor] Provide a custom constructor function
 * to be used as the subclass itself.
 * @param {object} [classProps={}] Static properties to add to the subclass.
 * @returns {Constructor} Subclass of this Query class.
 * @since 3.0.0
 */
</code></pre>
        </article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Sat Jan 25 2020 22:32:20 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
