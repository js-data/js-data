<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <title>Schema.js - Documentation</title>


    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav class="wrap">

    <input type="text" id="nav-search" placeholder="Search" />

    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Collection.html">Collection</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Collection.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Collection.html#add">add</a></li><li data-type='method' style='display: none;'><a href="Collection.html#afterRemove">afterRemove</a></li><li data-type='method' style='display: none;'><a href="Collection.html#afterRemoveAll">afterRemoveAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#beforeAdd">beforeAdd</a></li><li data-type='method' style='display: none;'><a href="Collection.html#beforeRemove">beforeRemove</a></li><li data-type='method' style='display: none;'><a href="Collection.html#beforeRemoveAll">beforeRemoveAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#between">between</a></li><li data-type='method' style='display: none;'><a href="Collection.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="Collection.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Collection.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Collection.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="Collection.html#forEach">forEach</a></li><li data-type='method' style='display: none;'><a href="Collection.html#get">get</a></li><li data-type='method' style='display: none;'><a href="Collection.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#getIndex">getIndex</a></li><li data-type='method' style='display: none;'><a href="Collection.html#limit">limit</a></li><li data-type='method' style='display: none;'><a href="Collection.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Collection.html#map">map</a></li><li data-type='method' style='display: none;'><a href="Collection.html#mapCall">mapCall</a></li><li data-type='method' style='display: none;'><a href="Collection.html#method">method</a></li><li data-type='method' style='display: none;'><a href="Collection.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Collection.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Collection.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="Collection.html#query">query</a></li><li data-type='method' style='display: none;'><a href="Collection.html#recordId">recordId</a></li><li data-type='method' style='display: none;'><a href="Collection.html#reduce">reduce</a></li><li data-type='method' style='display: none;'><a href="Collection.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="Collection.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="Collection.html#skip">skip</a></li><li data-type='method' style='display: none;'><a href="Collection.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Collection.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="Collection.html#updateIndex">updateIndex</a></li><li data-type='method' style='display: none;'><a href="Collection.html#updateIndexes">updateIndexes</a></li></ul></li><li><a href="Component.html">Component</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Component.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Component.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Component.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Component.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Component.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Component.html#on">on</a></li></ul></li><li><a href="Container.html">Container</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Container.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Container.html#as">as</a></li><li data-type='method' style='display: none;'><a href="Container.html#count">count</a></li><li data-type='method' style='display: none;'><a href="Container.html#create">create</a></li><li data-type='method' style='display: none;'><a href="Container.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="Container.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="Container.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Container.html#defineMapper">defineMapper</a></li><li data-type='method' style='display: none;'><a href="Container.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Container.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="Container.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Container.html#find">find</a></li><li data-type='method' style='display: none;'><a href="Container.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="Container.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="Container.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="Container.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="Container.html#getMapper">getMapper</a></li><li data-type='method' style='display: none;'><a href="Container.html#getMapperByName">getMapperByName</a></li><li data-type='method' style='display: none;'><a href="Container.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="Container.html#is">is</a></li><li data-type='method' style='display: none;'><a href="Container.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Container.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Container.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Container.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="Container.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="Container.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Container.html#update">update</a></li><li data-type='method' style='display: none;'><a href="Container.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="Container.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="Container.html#validate">validate</a></li></ul></li><li><a href="DataStore.html">DataStore</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DataStore.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#add">add</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#addToCache">addToCache</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#as">as</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#between">between</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cachedFind">cachedFind</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cachedFindAll">cachedFindAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cacheFind">cacheFind</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#cacheFindAll">cacheFindAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#count">count</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#create">create</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#defineMapper">defineMapper</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#find">find</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#get">get</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getMapper">getMapper</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getMapperByName">getMapperByName</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#hashQuery">hashQuery</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#is">is</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#log">log</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#off">off</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#on">on</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#query">query</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#removeRelated">removeRelated</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#update">update</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="DataStore.html#validate">validate</a></li></ul></li><li><a href="LinkedCollection.html">LinkedCollection</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LinkedCollection.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#add">add</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#afterRemove">afterRemove</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#afterRemoveAll">afterRemoveAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#beforeAdd">beforeAdd</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#beforeRemove">beforeRemove</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#beforeRemoveAll">beforeRemoveAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#between">between</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#forEach">forEach</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#get">get</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#getIndex">getIndex</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#limit">limit</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#log">log</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#map">map</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#mapCall">mapCall</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#method">method</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#off">off</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#on">on</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#query">query</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#recordId">recordId</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#reduce">reduce</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#skip">skip</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#updateIndex">updateIndex</a></li><li data-type='method' style='display: none;'><a href="LinkedCollection.html#updateIndexes">updateIndexes</a></li></ul></li><li><a href="Mapper.html">Mapper</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Mapper.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterCount">afterCount</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterCreate">afterCreate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterCreateMany">afterCreateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterDestroy">afterDestroy</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterDestroyAll">afterDestroyAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterFind">afterFind</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterFindAll">afterFindAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterSum">afterSum</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterUpdate">afterUpdate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterUpdateAll">afterUpdateAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#afterUpdateMany">afterUpdateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeCount">beforeCount</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeCreate">beforeCreate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeCreateMany">beforeCreateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeDestroy">beforeDestroy</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeDestroyAll">beforeDestroyAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeFind">beforeFind</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeFindAll">beforeFindAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeSum">beforeSum</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeUpdate">beforeUpdate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeUpdateAll">beforeUpdateAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#beforeUpdateMany">beforeUpdateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#belongsTo">belongsTo</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#count">count</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#create">create</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#createInstance">createInstance</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#crud">crud</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#find">find</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#hasMany">hasMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#hasOne">hasOne</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#is">is</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#update">update</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="Mapper.html#wrap">wrap</a></li></ul></li><li><a href="Query.html">Query</a><ul class='members'><li data-type='member' style='display: none;'><a href="Query.html#.ops">ops</a></li><li data-type='member' style='display: none;'><a href="Query.html#collection">collection</a></li><li data-type='member' style='display: none;'><a href="Query.html#data">data</a></li><li data-type='member' style='display: none;'><a href="Query.html#debug">debug</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Query.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Query.html#between">between</a></li><li data-type='method' style='display: none;'><a href="Query.html#compare">compare</a></li><li data-type='method' style='display: none;'><a href="Query.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Query.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Query.html#evaluate">evaluate</a></li><li data-type='method' style='display: none;'><a href="Query.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="Query.html#forEach">forEach</a></li><li data-type='method' style='display: none;'><a href="Query.html#get">get</a></li><li data-type='method' style='display: none;'><a href="Query.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="Query.html#getData">getData</a></li><li data-type='method' style='display: none;'><a href="Query.html#like">like</a></li><li data-type='method' style='display: none;'><a href="Query.html#limit">limit</a></li><li data-type='method' style='display: none;'><a href="Query.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Query.html#map">map</a></li><li data-type='method' style='display: none;'><a href="Query.html#mapCall">mapCall</a></li><li data-type='method' style='display: none;'><a href="Query.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Query.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Query.html#run">run</a></li><li data-type='method' style='display: none;'><a href="Query.html#skip">skip</a></li></ul></li><li><a href="Record.html">Record</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Record.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Record.html#_mapper">_mapper</a></li><li data-type='method' style='display: none;'><a href="Record.html#afterLoadRelations">afterLoadRelations</a></li><li data-type='method' style='display: none;'><a href="Record.html#beforeLoadRelations">beforeLoadRelations</a></li><li data-type='method' style='display: none;'><a href="Record.html#changeHistory">changeHistory</a></li><li data-type='method' style='display: none;'><a href="Record.html#changes">changes</a></li><li data-type='method' style='display: none;'><a href="Record.html#commit">commit</a></li><li data-type='method' style='display: none;'><a href="Record.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Record.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="Record.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Record.html#get">get</a></li><li data-type='method' style='display: none;'><a href="Record.html#hasChanges">hasChanges</a></li><li data-type='method' style='display: none;'><a href="Record.html#isNew">isNew</a></li><li data-type='method' style='display: none;'><a href="Record.html#isValid">isValid</a></li><li data-type='method' style='display: none;'><a href="Record.html#loadRelations">loadRelations</a></li><li data-type='method' style='display: none;'><a href="Record.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Record.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Record.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Record.html#previous">previous</a></li><li data-type='method' style='display: none;'><a href="Record.html#revert">revert</a></li><li data-type='method' style='display: none;'><a href="Record.html#save">save</a></li><li data-type='method' style='display: none;'><a href="Record.html#set">set</a></li><li data-type='method' style='display: none;'><a href="Record.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="Record.html#unset">unset</a></li><li data-type='method' style='display: none;'><a href="Record.html#validate">validate</a></li></ul></li><li><a href="Schema.html">Schema</a><ul class='members'><li data-type='member' style='display: none;'><a href="Schema.html#.ANY_OPS">ANY_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.ARRAY_OPS">ARRAY_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.NUMERIC_OPS">NUMERIC_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.OBJECT_OPS">OBJECT_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.STRING_OPS">STRING_OPS</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.typeGroupValidators">typeGroupValidators</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.types">types</a></li><li data-type='member' style='display: none;'><a href="Schema.html#.validationKeywords">validationKeywords</a></li><li data-type='member' style='display: none;'><a href="Schema.html#debug">debug</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Schema.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Schema.html#.validate">validate</a></li><li data-type='method' style='display: none;'><a href="Schema.html#apply">apply</a></li><li data-type='method' style='display: none;'><a href="Schema.html#applyDefaults">applyDefaults</a></li><li data-type='method' style='display: none;'><a href="Schema.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="Schema.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="Schema.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Schema.html#makeDescriptor">makeDescriptor</a></li><li data-type='method' style='display: none;'><a href="Schema.html#off">off</a></li><li data-type='method' style='display: none;'><a href="Schema.html#on">on</a></li><li data-type='method' style='display: none;'><a href="Schema.html#pick">pick</a></li><li data-type='method' style='display: none;'><a href="Schema.html#validate">validate</a></li></ul></li><li><a href="Settable.html">Settable</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Settable.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="Settable.html#_get">_get</a></li></ul></li><li><a href="SimpleStore.html">SimpleStore</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SimpleStore.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#add">add</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#addToCache">addToCache</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#as">as</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#between">between</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cachedFind">cachedFind</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cachedFindAll">cachedFindAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cacheFind">cacheFind</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#cacheFindAll">cacheFindAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#clear">clear</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#count">count</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#create">create</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#createIndex">createIndex</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#createMany">createMany</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#createRecord">createRecord</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#dbg">dbg</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#defineMapper">defineMapper</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#destroy">destroy</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#destroyAll">destroyAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#emit">emit</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#filter">filter</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#find">find</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#findAll">findAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#get">get</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAdapter">getAdapter</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAdapterName">getAdapterName</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAdapters">getAdapters</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getAll">getAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getMapper">getMapper</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getMapperByName">getMapperByName</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#hashQuery">hashQuery</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#is">is</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#log">log</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#off">off</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#on">on</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#prune">prune</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#query">query</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#registerAdapter">registerAdapter</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#removeAll">removeAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#removeRelated">removeRelated</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#sum">sum</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#toJSON">toJSON</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#unsaved">unsaved</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#update">update</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#updateAll">updateAll</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#updateMany">updateMany</a></li><li data-type='method' style='display: none;'><a href="SimpleStore.html#validate">validate</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-js-data.html">js-data</a><ul class='members'><li data-type='member' style='display: none;'><a href="module-js-data.html#.Collection">Collection</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Component">Component</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Container">Container</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.DataStore">DataStore</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Index">Index</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.LinkedCollection">LinkedCollection</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Mapper">Mapper</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Query">Query</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Record">Record</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Schema">Schema</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.Settable">Settable</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.SimpleStore">SimpleStore</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.utils">utils</a></li><li data-type='member' style='display: none;'><a href="module-js-data.html#.version">version</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="module-js-data.html#.belongsTo">belongsTo</a></li><li data-type='method' style='display: none;'><a href="module-js-data.html#.hasMany">hasMany</a></li><li data-type='method' style='display: none;'><a href="module-js-data.html#.hasOne">hasOne</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="Collection.html#event:add">add</a></li><li><a href="Collection.html#event:change">change</a></li><li><a href="Collection.html#event:remove">remove</a></li><li><a href="Container.html#event:afterCreate">afterCreate</a></li><li><a href="Container.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="Container.html#event:afterDestroy">afterDestroy</a></li><li><a href="Container.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="Container.html#event:afterFind">afterFind</a></li><li><a href="Container.html#event:afterFindAll">afterFindAll</a></li><li><a href="Container.html#event:afterUpdate">afterUpdate</a></li><li><a href="Container.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="Container.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="Container.html#event:beforeCreate">beforeCreate</a></li><li><a href="Container.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="Container.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="Container.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="Container.html#event:beforeFind">beforeFind</a></li><li><a href="Container.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="Container.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="Container.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="Container.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="DataStore.html#event:add">add</a></li><li><a href="DataStore.html#event:afterCreate">afterCreate</a></li><li><a href="DataStore.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="DataStore.html#event:afterDestroy">afterDestroy</a></li><li><a href="DataStore.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="DataStore.html#event:afterFind">afterFind</a></li><li><a href="DataStore.html#event:afterFindAll">afterFindAll</a></li><li><a href="DataStore.html#event:afterUpdate">afterUpdate</a></li><li><a href="DataStore.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="DataStore.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="DataStore.html#event:beforeCreate">beforeCreate</a></li><li><a href="DataStore.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="DataStore.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="DataStore.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="DataStore.html#event:beforeFind">beforeFind</a></li><li><a href="DataStore.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="DataStore.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="DataStore.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="DataStore.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="DataStore.html#event:change">change</a></li><li><a href="DataStore.html#event:remove">remove</a></li><li><a href="LinkedCollection.html#event:add">add</a></li><li><a href="LinkedCollection.html#event:change">change</a></li><li><a href="LinkedCollection.html#event:remove">remove</a></li><li><a href="Mapper.html#event:afterCreate">afterCreate</a></li><li><a href="Mapper.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="Mapper.html#event:afterDestroy">afterDestroy</a></li><li><a href="Mapper.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="Mapper.html#event:afterFind">afterFind</a></li><li><a href="Mapper.html#event:afterFindAll">afterFindAll</a></li><li><a href="Mapper.html#event:afterUpdate">afterUpdate</a></li><li><a href="Mapper.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="Mapper.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="Mapper.html#event:beforeCreate">beforeCreate</a></li><li><a href="Mapper.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="Mapper.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="Mapper.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="Mapper.html#event:beforeFind">beforeFind</a></li><li><a href="Mapper.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="Mapper.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="Mapper.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="Mapper.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="Record.html#event:change">change</a></li><li><a href="SimpleStore.html#event:add">add</a></li><li><a href="SimpleStore.html#event:afterCreate">afterCreate</a></li><li><a href="SimpleStore.html#event:afterCreateMany">afterCreateMany</a></li><li><a href="SimpleStore.html#event:afterDestroy">afterDestroy</a></li><li><a href="SimpleStore.html#event:afterDestroyAll">afterDestroyAll</a></li><li><a href="SimpleStore.html#event:afterFind">afterFind</a></li><li><a href="SimpleStore.html#event:afterFindAll">afterFindAll</a></li><li><a href="SimpleStore.html#event:afterUpdate">afterUpdate</a></li><li><a href="SimpleStore.html#event:afterUpdateAll">afterUpdateAll</a></li><li><a href="SimpleStore.html#event:afterUpdateMany">afterUpdateMany</a></li><li><a href="SimpleStore.html#event:beforeCreate">beforeCreate</a></li><li><a href="SimpleStore.html#event:beforeCreateMany">beforeCreateMany</a></li><li><a href="SimpleStore.html#event:beforeDestroy">beforeDestroy</a></li><li><a href="SimpleStore.html#event:beforeDestroyAll">beforeDestroyAll</a></li><li><a href="SimpleStore.html#event:beforeFind">beforeFind</a></li><li><a href="SimpleStore.html#event:beforeFindAll">beforeFindAll</a></li><li><a href="SimpleStore.html#event:beforeUpdate">beforeUpdate</a></li><li><a href="SimpleStore.html#event:beforeUpdateAll">beforeUpdateAll</a></li><li><a href="SimpleStore.html#event:beforeUpdateMany">beforeUpdateMany</a></li><li><a href="SimpleStore.html#event:change">change</a></li><li><a href="SimpleStore.html#event:remove">remove</a></li></ul><h3>Namespaces</h3><ul><li><a href="query_.html">query</a><ul class='members'><li data-type='member' style='display: none;'><a href="query_.html#.limit">limit</a></li><li data-type='member' style='display: none;'><a href="query_.html#.offset">offset</a></li><li data-type='member' style='display: none;'><a href="query_.html#.orderBy">orderBy</a></li><li data-type='member' style='display: none;'><a href="query_.html#.where">where</a></li></ul></li><li><a href="utils.html">utils</a><ul class='members'><li data-type='member' style='display: none;'><a href="utils.html#.Promise">Promise</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="utils.html#.addHiddenPropsToTarget">addHiddenPropsToTarget</a></li><li data-type='method' style='display: none;'><a href="utils.html#.areDifferent">areDifferent</a></li><li data-type='method' style='display: none;'><a href="utils.html#.classCallCheck">classCallCheck</a></li><li data-type='method' style='display: none;'><a href="utils.html#.copy">copy</a></li><li data-type='method' style='display: none;'><a href="utils.html#.deepEqual">deepEqual</a></li><li data-type='method' style='display: none;'><a href="utils.html#.deepFillIn">deepFillIn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.deepMixIn">deepMixIn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.diffObjects">diffObjects</a></li><li data-type='method' style='display: none;'><a href="utils.html#.equal">equal</a></li><li data-type='method' style='display: none;'><a href="utils.html#.err">err</a></li><li data-type='method' style='display: none;'><a href="utils.html#.eventify">eventify</a></li><li data-type='method' style='display: none;'><a href="utils.html#.extend">extend</a></li><li data-type='method' style='display: none;'><a href="utils.html#.fillIn">fillIn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.findIndex">findIndex</a></li><li data-type='method' style='display: none;'><a href="utils.html#.forEachRelation">forEachRelation</a></li><li data-type='method' style='display: none;'><a href="utils.html#.forOwn">forOwn</a></li><li data-type='method' style='display: none;'><a href="utils.html#.fromJson">fromJson</a></li><li data-type='method' style='display: none;'><a href="utils.html#.get">get</a></li><li data-type='method' style='display: none;'><a href="utils.html#.getSuper">getSuper</a></li><li data-type='method' style='display: none;'><a href="utils.html#.intersection">intersection</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isArray">isArray</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isBlacklisted">isBlacklisted</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isBoolean">isBoolean</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isDate">isDate</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isFunction">isFunction</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isInteger">isInteger</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isNull">isNull</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isNumber">isNumber</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isObject">isObject</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isRegExp">isRegExp</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isSorN">isSorN</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isString">isString</a></li><li data-type='method' style='display: none;'><a href="utils.html#.isUndefined">isUndefined</a></li><li data-type='method' style='display: none;'><a href="utils.html#.logify">logify</a></li><li data-type='method' style='display: none;'><a href="utils.html#.noDupeAdd">noDupeAdd</a></li><li data-type='method' style='display: none;'><a href="utils.html#.omit">omit</a></li><li data-type='method' style='display: none;'><a href="utils.html#.pick">pick</a></li><li data-type='method' style='display: none;'><a href="utils.html#.plainCopy">plainCopy</a></li><li data-type='method' style='display: none;'><a href="utils.html#.reject">reject</a></li><li data-type='method' style='display: none;'><a href="utils.html#.remove">remove</a></li><li data-type='method' style='display: none;'><a href="utils.html#.resolve">resolve</a></li><li data-type='method' style='display: none;'><a href="utils.html#.set">set</a></li><li data-type='method' style='display: none;'><a href="utils.html#.toJson">toJson</a></li><li data-type='method' style='display: none;'><a href="utils.html#.unset">unset</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#_createOrAssignChildRecordIfRequired">_createOrAssignChildRecordIfRequired</a></li><li><a href="global.html#_createParentRecordIfRequired">_createParentRecordIfRequired</a></li></ul>
</nav>

<div id="main">

    <h1 class="page-title">Schema.js</h1>







    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import utils from './utils'
import Component from './Component'

const DOMAIN = 'Schema'

/**
 * A function map for each of the seven primitive JSON types defined by the core specification.
 * Each function will check a given value and return true or false if the value is an instance of that type.
 * ```
 *   types.integer(1) // returns true
 *   types.string({}) // returns false
 * ```
 * http://json-schema.org/latest/json-schema-core.html#anchor8
 * @name Schema.types
 * @type {object}
 */
const types = {
  array: utils.isArray,
  boolean: utils.isBoolean,
  integer: utils.isInteger,
  null: utils.isNull,
  number: utils.isNumber,
  object: utils.isObject,
  string: utils.isString
}

/**
 * @ignore
 */
const segmentToString = function (segment, prev) {
  let str = ''
  if (segment) {
    if (utils.isNumber(segment)) {
      str += `[${segment}]`
    } else if (prev) {
      str += `.${segment}`
    } else {
      str += `${segment}`
    }
  }
  return str
}

/**
 * @ignore
 */
const makePath = function (opts) {
  opts || (opts = {})
  let path = ''
  const segments = opts.path || []
  segments.forEach(function (segment) {
    path += segmentToString(segment, path)
  })
  path += segmentToString(opts.prop, path)
  return path
}

/**
 * @ignore
 */
const makeError = function (actual, expected, opts) {
  return {
    expected,
    actual: '' + actual,
    path: makePath(opts)
  }
}

/**
 * @ignore
 */
const addError = function (actual, expected, opts, errors) {
  errors.push(makeError(actual, expected, opts))
}

/**
 * @ignore
 */
const maxLengthCommon = function (keyword, value, schema, opts) {
  const max = schema[keyword]
  if (value.length > max) {
    return makeError(value.length, `length no more than ${max}`, opts)
  }
}

/**
 * @ignore
 */
const minLengthCommon = function (keyword, value, schema, opts) {
  const min = schema[keyword]
  if (value.length &lt; min) {
    return makeError(value.length, `length no less than ${min}`, opts)
  }
}

/**
 * A map of all object member validation functions for each keyword defined in the JSON Schema.
 * @name Schema.validationKeywords
 * @type {object}
 */
const validationKeywords = {
  /**
   * Validates the provided value against all schemas defined in the Schemas `allOf` keyword.
   * The instance is valid against if and only if it is valid against all the schemas declared in the Schema's value.
   *
   * The value of this keyword MUST be an array. This array MUST have at least one element.
   * Each element of this array MUST be a valid JSON Schema.
   *
   * see http://json-schema.org/latest/json-schema-validation.html#anchor82
   *
   * @name Schema.validationKeywords.allOf
   * @method
   * @param {*} value Value to be validated.
   * @param {object} schema Schema containing the `allOf` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  allOf (value, schema, opts) {
    let allErrors = []
    schema.allOf.forEach(function (_schema) {
      allErrors = allErrors.concat(validate(value, _schema, opts) || [])
    })
    return allErrors.length ? allErrors : undefined
  },

  /**
   * Validates the provided value against all schemas defined in the Schemas `anyOf` keyword.
   * The instance is valid against this keyword if and only if it is valid against
   * at least one of the schemas in this keyword's value.
   *
   * The value of this keyword MUST be an array. This array MUST have at least one element.
   * Each element of this array MUST be an object, and each object MUST be a valid JSON Schema.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor85
   *
   * @name Schema.validationKeywords.anyOf
   * @method
   * @param {*} value Value to be validated.
   * @param {object} schema Schema containing the `anyOf` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  anyOf (value, schema, opts) {
    let validated = false
    let allErrors = []
    schema.anyOf.forEach(function (_schema) {
      const errors = validate(value, _schema, opts)
      if (errors) {
        allErrors = allErrors.concat(errors)
      } else {
        validated = true
      }
    })
    return validated ? undefined : allErrors
  },

  /**
   * http://json-schema.org/latest/json-schema-validation.html#anchor70
   *
   * @name Schema.validationKeywords.dependencies
   * @method
   * @param {*} value TODO
   * @param {object} schema TODO
   * @param {object} opts TODO
   */
  dependencies (value, schema, opts) {
    // TODO
  },

  /**
   * Validates the provided value against an array of possible values defined by the Schema's `enum` keyword
   * Validation succeeds if the value is deeply equal to one of the values in the array.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor76
   *
   * @name Schema.validationKeywords.enum
   * @method
   * @param {*} value Value to validate
   * @param {object} schema Schema containing the `enum` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  enum (value, schema, opts) {
    const possibleValues = schema.enum
    if (utils.findIndex(possibleValues, (item) => utils.deepEqual(item, value)) === -1) {
      return makeError(value, `one of (${possibleValues.join(', ')})`, opts)
    }
  },

  /**
   * Validates each of the provided array values against a schema or an array of schemas defined by the Schema's `items` keyword
   * see http://json-schema.org/latest/json-schema-validation.html#anchor37 for validation rules.
   *
   * @name Schema.validationKeywords.items
   * @method
   * @param {*} value Array to be validated.
   * @param {object} schema Schema containing the items keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  items (value, schema, opts) {
    opts || (opts = {})
    // TODO: additionalItems
    let items = schema.items
    let errors = []
    const checkingTuple = utils.isArray(items)
    const length = value.length
    for (var prop = 0; prop &lt; length; prop++) {
      if (checkingTuple) {
        // Validating a tuple, instead of just checking each item against the
        // same schema
        items = schema.items[prop]
      }
      opts.prop = prop
      errors = errors.concat(validate(value[prop], items, opts) || [])
    }
    return errors.length ? errors : undefined
  },

  /**
   * Validates the provided number against a maximum value defined by the Schema's `maximum` keyword
   * Validation succeeds if the value is a number, and is less than, or equal to, the value of this keyword.
   * http://json-schema.org/latest/json-schema-validation.html#anchor17
   *
   * @name Schema.validationKeywords.maximum
   * @method
   * @param {*} value Number to validate against the keyword.
   * @param {object} schema Schema containing the `maximum` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  maximum (value, schema, opts) {
    // Must be a number
    const maximum = schema.maximum
    // Must be a boolean
    // Depends on maximum
    // default: false
    const exclusiveMaximum = schema.exclusiveMaximum
    if (typeof value === typeof maximum &amp;&amp; !(exclusiveMaximum ? maximum > value : maximum >= value)) {
      return exclusiveMaximum
        ? makeError(value, `no more than nor equal to ${maximum}`, opts)
        : makeError(value, `no more than ${maximum}`, opts)
    }
  },

  /**
   * Validates the length of the provided array against a maximum value defined by the Schema's `maxItems` keyword.
   * Validation succeeds if the length of the array is less than, or equal to the value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor42
   *
   * @name Schema.validationKeywords.maxItems
   * @method
   * @param {*} value Array to be validated.
   * @param {object} schema Schema containing the `maxItems` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  maxItems (value, schema, opts) {
    if (utils.isArray(value)) {
      return maxLengthCommon('maxItems', value, schema, opts)
    }
  },

  /**
   * Validates the length of the provided string against a maximum value defined in the Schema's `maxLength` keyword.
   * Validation succeeds if the length of the string is less than, or equal to the value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor26
   *
   * @name Schema.validationKeywords.maxLength
   * @method
   * @param {*} value String to be validated.
   * @param {object} schema Schema containing the `maxLength` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  maxLength (value, schema, opts) {
    return maxLengthCommon('maxLength', value, schema, opts)
  },

  /**
   * Validates the count of the provided object's properties against a maximum value defined in the Schema's `maxProperties` keyword.
   * Validation succeeds if the object's property count is less than, or equal to the value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor54
   *
   * @name Schema.validationKeywords.maxProperties
   * @method
   * @param {*} value Object to be validated.
   * @param {object} schema Schema containing the `maxProperties` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  maxProperties (value, schema, opts) {
    // validate only objects
    if (!utils.isObject(value)) return
    const maxProperties = schema.maxProperties
    const length = Object.keys(value).length
    if (length > maxProperties) {
      return makeError(length, `no more than ${maxProperties} properties`, opts)
    }
  },

  /**
   * Validates the provided value against a minimum value defined by the Schema's `minimum` keyword
   * Validation succeeds if the value is a number and is greater than, or equal to, the value of this keyword.
   * http://json-schema.org/latest/json-schema-validation.html#anchor21
   *
   * @name Schema.validationKeywords.minimum
   * @method
   * @param {*} value Number to validate against the keyword.
   * @param {object} schema Schema containing the `minimum` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  minimum (value, schema, opts) {
    // Must be a number
    const minimum = schema.minimum
    // Must be a boolean
    // Depends on minimum
    // default: false
    const exclusiveMinimum = schema.exclusiveMinimum
    if (typeof value === typeof minimum &amp;&amp; !(exclusiveMinimum ? value > minimum : value >= minimum)) {
      return exclusiveMinimum
        ? makeError(value, `no less than nor equal to ${minimum}`, opts)
        : makeError(value, `no less than ${minimum}`, opts)
    }
  },

  /**
   * Validates the length of the provided array against a minimum value defined by the Schema's `minItems` keyword.
   * Validation succeeds if the length of the array is greater than, or equal to the value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor45
   *
   * @name Schema.validationKeywords.minItems
   * @method
   * @param {*} value Array to be validated.
   * @param {object} schema Schema containing the `minItems` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  minItems (value, schema, opts) {
    if (utils.isArray(value)) {
      return minLengthCommon('minItems', value, schema, opts)
    }
  },

  /**
   * Validates the length of the provided string against a minimum value defined in the Schema's `minLength` keyword.
   * Validation succeeds if the length of the string is greater than, or equal to the value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor29
   *
   * @name Schema.validationKeywords.minLength
   * @method
   * @param {*} value String to be validated.
   * @param {object} schema Schema containing the `minLength` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  minLength (value, schema, opts) {
    return minLengthCommon('minLength', value, schema, opts)
  },

  /**
   * Validates the count of the provided object's properties against a minimum value defined in the Schema's `minProperties` keyword.
   * Validation succeeds if the object's property count is greater than, or equal to the value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor57
   *
   * @name Schema.validationKeywords.minProperties
   * @method
   * @param {*} value Object to be validated.
   * @param {object} schema Schema containing the `minProperties` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  minProperties (value, schema, opts) {
    // validate only objects
    if (!utils.isObject(value)) return
    const minProperties = schema.minProperties
    const length = Object.keys(value).length
    if (length &lt; minProperties) {
      return makeError(length, `no more than ${minProperties} properties`, opts)
    }
  },

  /**
   * Validates the provided number is a multiple of the number defined in the Schema's `multipleOf` keyword.
   * Validation succeeds if the number can be divided equally into the value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor14
   *
   * @name Schema.validationKeywords.multipleOf
   * @method
   * @param {*} value Number to be validated.
   * @param {object} schema Schema containing the `multipleOf` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  multipleOf (value, schema, opts) {
    const multipleOf = schema.multipleOf
    if (utils.isNumber(value)) {
      if ((value / multipleOf) % 1 !== 0) {
        return makeError(value, `multipleOf ${multipleOf}`, opts)
      }
    }
  },

  /**
   * Validates the provided value is not valid with any of the schemas defined in the Schema's `not` keyword.
   * An instance is valid against this keyword if and only if it is NOT valid against the schemas in this keyword's value.
   *
   * see http://json-schema.org/latest/json-schema-validation.html#anchor91
   * @name Schema.validationKeywords.not
   * @method
   * @param {*} value to be checked.
   * @param {object} schema Schema containing the not keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  not (value, schema, opts) {
    if (!validate(value, schema.not, opts)) {
      // TODO: better messaging
      return makeError('succeeded', 'should have failed', opts)
    }
  },

  /**
   * Validates the provided value is valid with one and only one of the schemas defined in the Schema's `oneOf` keyword.
   * An instance is valid against this keyword if and only if it is valid against a single schemas in this keyword's value.
   *
   * see http://json-schema.org/latest/json-schema-validation.html#anchor88
   * @name Schema.validationKeywords.oneOf
   * @method
   * @param {*} value to be checked.
   * @param {object} schema Schema containing the `oneOf` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  oneOf (value, schema, opts) {
    let validated = false
    let allErrors = []
    schema.oneOf.forEach(function (_schema) {
      const errors = validate(value, _schema, opts)
      if (errors) {
        allErrors = allErrors.concat(errors)
      } else if (validated) {
        allErrors = [makeError('valid against more than one', 'valid against only one', opts)]
        validated = false
        return false
      } else {
        validated = true
      }
    })
    return validated ? undefined : allErrors
  },

  /**
   * Validates the provided string matches a pattern defined in the Schema's `pattern` keyword.
   * Validation succeeds if the string is a match of the regex value of this keyword.
   *
   * see http://json-schema.org/latest/json-schema-validation.html#anchor33
   * @name Schema.validationKeywords.pattern
   * @method
   * @param {*} value String to be validated.
   * @param {object} schema Schema containing the `pattern` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  pattern (value, schema, opts) {
    const pattern = schema.pattern
    if (utils.isString(value) &amp;&amp; !value.match(pattern)) {
      return makeError(value, pattern, opts)
    }
  },

  /**
   * Validates the provided object's properties against a map of values defined in the Schema's `properties` keyword.
   * Validation succeeds if the object's property are valid with each of the schema's in the provided map.
   * Validation also depends on the additionalProperties and or patternProperties.
   *
   * see http://json-schema.org/latest/json-schema-validation.html#anchor64 for more info.
   *
   * @name Schema.validationKeywords.properties
   * @method
   * @param {*} value Object to be validated.
   * @param {object} schema Schema containing the `properties` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  properties (value, schema, opts) {
    opts || (opts = {})

    if (utils.isArray(value)) {
      return
    }

    // Can be a boolean or an object
    // Technically the default is an "empty schema", but here "true" is
    // functionally the same
    const additionalProperties = schema.additionalProperties === undefined ? true : schema.additionalProperties
    const validated = []
    // "p": The property set from "properties".
    // Default is an object
    const properties = schema.properties || {}
    // "pp": The property set from "patternProperties".
    // Default is an object
    const patternProperties = schema.patternProperties || {}
    let errors = []

    utils.forOwn(properties, function (_schema, prop) {
      opts.prop = prop
      errors = errors.concat(validate(value[prop], _schema, opts) || [])
      validated.push(prop)
    })

    const toValidate = utils.omit(value, validated)
    utils.forOwn(patternProperties, function (_schema, pattern) {
      utils.forOwn(toValidate, function (undef, prop) {
        if (prop.match(pattern)) {
          opts.prop = prop
          errors = errors.concat(validate(value[prop], _schema, opts) || [])
          validated.push(prop)
        }
      })
    })
    const keys = Object.keys(utils.omit(value, validated))
    // If "s" is not empty, validation fails
    if (additionalProperties === false) {
      if (keys.length) {
        const origProp = opts.prop
        opts.prop = ''
        addError(`extra fields: ${keys.join(', ')}`, 'no extra fields', opts, errors)
        opts.prop = origProp
      }
    } else if (utils.isObject(additionalProperties)) {
      // Otherwise, validate according to provided schema
      keys.forEach(function (prop) {
        opts.prop = prop
        errors = errors.concat(validate(value[prop], additionalProperties, opts) || [])
      })
    }
    return errors.length ? errors : undefined
  },

  /**
   * Validates the provided object's has all properties listed in the Schema's `properties` keyword array.
   * Validation succeeds if the object contains all properties provided in the array value of this keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor61
   *
   * @name Schema.validationKeywords.required
   * @method
   * @param {*} value Object to be validated.
   * @param {object} schema Schema containing the `required` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  required (value, schema, opts) {
    opts || (opts = {})
    const required = schema.required
    const errors = []
    if (!opts.existingOnly) {
      required.forEach(function (prop) {
        if (utils.get(value, prop) === undefined) {
          const prevProp = opts.prop
          opts.prop = prop
          addError(undefined, 'a value', opts, errors)
          opts.prop = prevProp
        }
      })
    }
    return errors.length ? errors : undefined
  },

  /**
   * Validates the provided value's type is equal to the type, or array of types, defined in the Schema's `type` keyword.
   * see http://json-schema.org/latest/json-schema-validation.html#anchor79
   *
   * @name Schema.validationKeywords.type
   * @method
   * @param {*} value Value to be validated.
   * @param {object} schema Schema containing the `type` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  type (value, schema, opts) {
    let type = schema.type
    let validType
    // Can be one of several types
    if (utils.isString(type)) {
      type = [type]
    }
    // Try to match the value against an expected type
    type.forEach(function (_type) {
      // TODO: throw an error if type is not defined
      if (types[_type](value, schema, opts)) {
        // Matched a type
        validType = _type
        return false
      }
    })
    // Value did not match any expected type
    if (!validType) {
      return makeError(value !== undefined &amp;&amp; value !== null ? typeof value : '' + value, `one of (${type.join(', ')})`, opts)
    }
    // Run keyword validators for matched type
    // http://json-schema.org/latest/json-schema-validation.html#anchor12
    const validator = typeGroupValidators[validType]
    if (validator) {
      return validator(value, schema, opts)
    }
  },

  /**
   * Validates the provided array values are unique.
   * Validation succeeds if the items in the array are unique, but only if the value of this keyword is true
   * see http://json-schema.org/latest/json-schema-validation.html#anchor49
   *
   * @name Schema.validationKeywords.uniqueItems
   * @method
   * @param {*} value Array to be validated.
   * @param {object} schema Schema containing the `uniqueItems` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  uniqueItems (value, schema, opts) {
    if (value &amp;&amp; value.length &amp;&amp; schema.uniqueItems) {
      const length = value.length
      let item, i, j
      // Check n - 1 items
      for (i = length - 1; i > 0; i--) {
        item = value[i]
        // Only compare against unchecked items
        for (j = i - 1; j >= 0; j--) {
          // Found a duplicate
          if (utils.deepEqual(item, value[j])) {
            return makeError(item, 'no duplicates', opts)
          }
        }
      }
    }
  }
}

/**
 * @ignore
 */
const runOps = function (ops, value, schema, opts) {
  let errors = []
  ops.forEach(function (op) {
    if (schema[op] !== undefined) {
      errors = errors.concat(validationKeywords[op](value, schema, opts) || [])
    }
  })
  return errors.length ? errors : undefined
}

/**
 * Validation keywords validated for any type:
 *
 * - `enum`
 * - `type`
 * - `allOf`
 * - `anyOf`
 * - `oneOf`
 * - `not`
 *
 * @name Schema.ANY_OPS
 * @type {string[]}
 */
const ANY_OPS = ['enum', 'type', 'allOf', 'anyOf', 'oneOf', 'not']

/**
 * Validation keywords validated for array types:
 *
 * - `items`
 * - `maxItems`
 * - `minItems`
 * - `uniqueItems`
 *
 * @name Schema.ARRAY_OPS
 * @type {string[]}
 */
const ARRAY_OPS = ['items', 'maxItems', 'minItems', 'uniqueItems']

/**
 * Validation keywords validated for numeric (number and integer) types:
 *
 * - `multipleOf`
 * - `maximum`
 * - `minimum`
 *
 * @name Schema.NUMERIC_OPS
 * @type {string[]}
 */
const NUMERIC_OPS = ['multipleOf', 'maximum', 'minimum']

/**
 * Validation keywords validated for object types:
 *
 * - `maxProperties`
 * - `minProperties`
 * - `required`
 * - `properties`
 * - `dependencies`
 *
 * @name Schema.OBJECT_OPS
 * @type {string[]}
 */
const OBJECT_OPS = ['maxProperties', 'minProperties', 'required', 'properties', 'dependencies']

/**
 * Validation keywords validated for string types:
 *
 * - `maxLength`
 * - `minLength`
 * - `pattern`
 *
 * @name Schema.STRING_OPS
 * @type {string[]}
 */
const STRING_OPS = ['maxLength', 'minLength', 'pattern']

/**
 * http://json-schema.org/latest/json-schema-validation.html#anchor75
 * @ignore
 */
const validateAny = function (value, schema, opts) {
  return runOps(ANY_OPS, value, schema, opts)
}

/**
 * Validates the provided value against a given Schema according to the http://json-schema.org/ v4 specification.
 *
 * @name Schema.validate
 * @method
 * @param {*} value Value to be validated.
 * @param {object} schema Valid Schema according to the http://json-schema.org/ v4 specification.
 * @param {object} [opts] Configuration options.
 * @returns {(array|undefined)} Array of errors or `undefined` if valid.
 */
const validate = function (value, schema, opts) {
  let errors = []
  opts || (opts = {})
  opts.ctx || (opts.ctx = { value, schema })
  let shouldPop
  const prevProp = opts.prop
  if (schema === undefined) {
    return
  }
  if (!utils.isObject(schema)) {
    throw utils.err(`${DOMAIN}#validate`)(500, `Invalid schema at path: "${opts.path}"`)
  }
  if (opts.path === undefined) {
    opts.path = []
  }
  // Track our location as we recurse
  if (opts.prop !== undefined) {
    shouldPop = true
    opts.path.push(opts.prop)
    opts.prop = undefined
  }
  // Validate against parent schema
  if (schema.extends) {
    // opts.path = path
    // opts.prop = prop
    if (utils.isFunction(schema.extends.validate)) {
      errors = errors.concat(schema.extends.validate(value, opts) || [])
    } else {
      errors = errors.concat(validate(value, schema.extends, opts) || [])
    }
  }
  if (value === undefined) {
    // Check if property is required
    if (schema.required === true &amp;&amp; !opts.existingOnly) {
      addError(value, 'a value', opts, errors)
    }
    if (shouldPop) {
      opts.path.pop()
      opts.prop = prevProp
    }
    return errors.length ? errors : undefined
  }

  errors = errors.concat(validateAny(value, schema, opts) || [])
  if (shouldPop) {
    opts.path.pop()
    opts.prop = prevProp
  }
  return errors.length ? errors : undefined
}

// These strings are cached for optimal performance of the change detection
// boolean - Whether a Record is changing in the current execution frame
const changingPath = 'changing'
// string[] - Properties that have changed in the current execution frame
const changedPath = 'changed'
// Object[] - History of change records
const changeHistoryPath = 'history'
// boolean - Whether a Record is currently being instantiated
const creatingPath = 'creating'
// number - The setTimeout change event id of a Record, if any
const eventIdPath = 'eventId'
// boolean - Whether to skip validation for a Record's currently changing property
const noValidatePath = 'noValidate'
// boolean - Whether to preserve Change History for a Record
const keepChangeHistoryPath = 'keepChangeHistory'
// boolean - Whether to skip change notification for a Record's currently
// changing property
const silentPath = 'silent'
const validationFailureMsg = 'validation failed'

/**
 * A map of validation functions grouped by type.
 *
 * @name Schema.typeGroupValidators
 * @type {object}
 */
const typeGroupValidators = {
  /**
   * Validates the provided value against the schema using all of the validation keywords specific to instances of an array.
   * The validation keywords for the type `array` are:
   *```
   * ['items', 'maxItems', 'minItems', 'uniqueItems']
   *```
   * see http://json-schema.org/latest/json-schema-validation.html#anchor25
   *
   * @name Schema.typeGroupValidators.array
   * @method
   * @param {*} value Array to be validated.
   * @param {object} schema Schema containing at least one array keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  array: function (value, schema, opts) {
    return runOps(ARRAY_OPS, value, schema, opts)
  },

  /**
   * Validates the provided value against the schema using all of the validation keywords specific to instances of an integer.
   * The validation keywords for the type `integer` are:
   *```
   * ['multipleOf', 'maximum', 'minimum']
   *```
   * @name Schema.typeGroupValidators.integer
   * @method
   * @param {*} value Number to be validated.
   * @param {object} schema Schema containing at least one `integer` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  integer: function (value, schema, opts) {
    // Additional validations for numerics are the same
    return typeGroupValidators.numeric(value, schema, opts)
  },

  /**
   * Validates the provided value against the schema using all of the validation keywords specific to instances of an number.
   * The validation keywords for the type `number` are:
   *```
   * ['multipleOf', 'maximum', 'minimum']
   *```
   * @name Schema.typeGroupValidators.number
   * @method
   * @param {*} value Number to be validated.
   * @param {object} schema Schema containing at least one `number` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  number: function (value, schema, opts) {
    // Additional validations for numerics are the same
    return typeGroupValidators.numeric(value, schema, opts)
  },

  /**
   * Validates the provided value against the schema using all of the validation keywords specific to instances of a number or integer.
   * The validation keywords for the type `numeric` are:
   *```
   * ['multipleOf', 'maximum', 'minimum']
   *```
   * See http://json-schema.org/latest/json-schema-validation.html#anchor13.
   *
   * @name Schema.typeGroupValidators.numeric
   * @method
   * @param {*} value Number to be validated.
   * @param {object} schema Schema containing at least one `numeric` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  numeric: function (value, schema, opts) {
    return runOps(NUMERIC_OPS, value, schema, opts)
  },

  /**
   * Validates the provided value against the schema using all of the validation keywords specific to instances of an object.
   * The validation keywords for the type `object` are:
   *```
   * ['maxProperties', 'minProperties', 'required', 'properties', 'dependencies']
   *```
   * See http://json-schema.org/latest/json-schema-validation.html#anchor53.
   *
   * @name Schema.typeGroupValidators.object
   * @method
   * @param {*} value Object to be validated.
   * @param {object} schema Schema containing at least one `object` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  object: function (value, schema, opts) {
    return runOps(OBJECT_OPS, value, schema, opts)
  },

  /**
   * Validates the provided value against the schema using all of the validation keywords specific to instances of an string.
   * The validation keywords for the type `string` are:
   *```
   * ['maxLength', 'minLength', 'pattern']
   *```
   * See http://json-schema.org/latest/json-schema-validation.html#anchor25.
   *
   * @name Schema.typeGroupValidators.string
   * @method
   * @param {*} value String to be validated.
   * @param {object} schema Schema containing at least one `string` keyword.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  string: function (value, schema, opts) {
    return runOps(STRING_OPS, value, schema, opts)
  }
}

/**
 * js-data's Schema class.
 *
 * @example &lt;caption>Schema#constructor&lt;/caption>
 * const JSData = require('js-data');
 * const { Schema } = JSData;
 * console.log('Using JSData v' + JSData.version.full);
 *
 * const PostSchema = new Schema({
 *   type: 'object',
 *   properties: {
 *     title: { type: 'string' }
 *   }
 * });
 * PostSchema.validate({ title: 1234 });
 *
 * @class Schema
 * @extends Component
 * @param {object} definition Schema definition according to json-schema.org
 */
function Schema (definition) {
  definition || (definition = {})
  // TODO: schema validation
  utils.fillIn(this, definition)

  if (this.type === 'object') {
    this.properties = this.properties || {}
    utils.forOwn(this.properties, (_definition, prop) => {
      if (!(_definition instanceof Schema)) {
        this.properties[prop] = new Schema(_definition)
      }
    })
  } else if (this.type === 'array' &amp;&amp; this.items &amp;&amp; !(this.items instanceof Schema)) {
    this.items = new Schema(this.items)
  }
  if (this.extends &amp;&amp; !(this.extends instanceof Schema)) {
    this.extends = new Schema(this.extends)
  }
  ['allOf', 'anyOf', 'oneOf'].forEach((validationKeyword) => {
    if (this[validationKeyword]) {
      this[validationKeyword].forEach((_definition, i) => {
        if (!(_definition instanceof Schema)) {
          this[validationKeyword][i] = new Schema(_definition)
        }
      })
    }
  })
}

export default Component.extend({
  constructor: Schema,

  /**
   * This adds ES5 getters/setters to the target based on the "properties" in
   * this Schema, which makes possible change tracking and validation on
   * property assignment.
   *
   * @name Schema#apply
   * @method
   * @param {object} target The prototype to which to apply this schema.
   */
  apply (target, opts) {
    opts || (opts = {})
    opts.getter || (opts.getter = '_get')
    opts.setter || (opts.setter = '_set')
    opts.unsetter || (opts.unsetter = '_unset')
    opts.track || (opts.track = this.track)
    const properties = this.properties || {}
    utils.forOwn(properties, (schema, prop) => {
      Object.defineProperty(
        target,
        prop,
        this.makeDescriptor(prop, schema, opts)
      )
    })
  },

  /**
   * Apply default values to the target object for missing values.
   *
   * @name Schema#applyDefaults
   * @method
   * @param {object} target The target to which to apply values for missing values.
   */
  applyDefaults (target) {
    if (!target) {
      return
    }
    const properties = this.properties || {}
    const hasSet = utils.isFunction(target.set) || utils.isFunction(target._set)
    utils.forOwn(properties, function (schema, prop) {
      if (Object.hasOwnProperty.call(schema, 'default') &amp;&amp; utils.get(target, prop) === undefined) {
        if (hasSet) {
          target.set(prop, utils.plainCopy(schema.default), { silent: true })
        } else {
          utils.set(target, prop, utils.plainCopy(schema.default))
        }
      }
      if (schema.type === 'object' &amp;&amp; schema.properties) {
        if (hasSet) {
          const orig = target._get('noValidate')
          target._set('noValidate', true)
          utils.set(target, prop, utils.get(target, prop) || {}, { silent: true })
          target._set('noValidate', orig)
        } else {
          utils.set(target, prop, utils.get(target, prop) || {})
        }
        schema.applyDefaults(utils.get(target, prop))
      }
    })
  },

  /**
   * Assemble a property descriptor for tracking and validating changes to
   * a property according to the given schema. This method is called when
   * {@link Mapper#applySchema} is set to `true`.
   *
   * @name Schema#makeDescriptor
   * @method
   * @param {string} prop The property name.
   * @param {(Schema|object)} schema The schema for the property.
   * @param {object} [opts] Optional configuration.
   * @param {function} [opts.getter] Custom getter function.
   * @param {function} [opts.setter] Custom setter function.
   * @param {function} [opts.track] Whether to track changes.
   * @returns {object} A property descriptor for the given schema.
   */
  makeDescriptor (prop, schema, opts) {
    const descriptor = {
      // Better to allow configurability, but at the user's own risk
      configurable: true,
      // These properties are enumerable by default, but regardless of their
      // enumerability, they won't be "own" properties of individual records
      enumerable: schema.enumerable === undefined ? true : !!schema.enumerable
    }
    // Cache a few strings for optimal performance
    const keyPath = `props.${prop}`
    const previousPath = `previous.${prop}`
    const getter = opts.getter
    const setter = opts.setter
    const unsetter = opts.unsetter
    const track = utils.isBoolean(opts.track) ? opts.track : schema.track

    descriptor.get = function () {
      return this._get(keyPath)
    }

    if (utils.isFunction(schema.get)) {
      const originalGet = descriptor.get
      descriptor.get = function () {
        return schema.get.call(this, originalGet)
      }
    }

    descriptor.set = function (value) {
      // These are accessed a lot
      const _get = this[getter]
      const _set = this[setter]
      const _unset = this[unsetter]
      // Optionally check that the new value passes validation
      if (!_get(noValidatePath)) {
        const errors = schema.validate(value, { path: [prop] })
        if (errors) {
          // Immediately throw an error, preventing the record from getting into
          // an invalid state
          const error = new Error(validationFailureMsg)
          error.errors = errors
          throw error
        }
      }
      // TODO: Make it so tracking can be turned on for all properties instead of
      // only per-property
      if (track &amp;&amp; !_get(creatingPath)) {
        // previous is versioned on database commit
        // props are versioned on set()
        const previous = _get(previousPath)
        const current = _get(keyPath)
        let changing = _get(changingPath)
        let changed = _get(changedPath)

        if (!changing) {
          // Track properties that are changing in the current event loop
          changed = []
        }

        // Add changing properties to this array once at most
        const index = changed.indexOf(prop)
        if (current !== value &amp;&amp; index === -1) {
          changed.push(prop)
        }
        if (previous === value) {
          if (index >= 0) {
            changed.splice(index, 1)
          }
        }
        // No changes in current event loop
        if (!changed.length) {
          changing = false
          _unset(changingPath)
          _unset(changedPath)
          // Cancel pending change event
          if (_get(eventIdPath)) {
            clearTimeout(_get(eventIdPath))
            _unset(eventIdPath)
          }
        }
        // Changes detected in current event loop
        if (!changing &amp;&amp; changed.length) {
          _set(changedPath, changed)
          _set(changingPath, true)
          // Saving the timeout id allows us to batch all changes in the same
          // event loop into a single "change"
          // TODO: Optimize
          _set(eventIdPath, setTimeout(() => {
            // Previous event loop where changes were gathered has ended, so
            // notify any listeners of those changes and prepare for any new
            // changes
            _unset(changedPath)
            _unset(eventIdPath)
            _unset(changingPath)
            // TODO: Optimize
            if (!_get(silentPath)) {
              let i
              for (i = 0; i &lt; changed.length; i++) {
                this.emit('change:' + changed[i], this, utils.get(this, changed[i]))
              }

              const changes = utils.diffObjects({ [prop]: value }, { [prop]: current })

              if (_get(keepChangeHistoryPath)) {
                const changeRecord = utils.plainCopy(changes)
                changeRecord.timestamp = new Date().getTime()
                let changeHistory = _get(changeHistoryPath)
                !changeHistory &amp;&amp; _set(changeHistoryPath, (changeHistory = []))
                changeHistory.push(changeRecord)
              }
              this.emit('change', this, changes)
            }
            _unset(silentPath)
          }, 0))
        }
      }
      _set(keyPath, value)
      return value
    }

    if (utils.isFunction(schema.set)) {
      const originalSet = descriptor.set
      descriptor.set = function (value) {
        return schema.set.call(this, value, originalSet)
      }
    }

    return descriptor
  },

  /**
   * Create a copy of the given value that contains only the properties defined
   * in this schema.
   *
   * @name Schema#pick
   * @method
   * @param {*} value The value to copy.
   * @returns {*} The copy.
   */
  pick (value) {
    if (value === undefined) {
      return
    }
    if (this.type === 'object') {
      const copy = {}
      const properties = this.properties
      if (properties) {
        utils.forOwn(properties, (_definition, prop) => {
          copy[prop] = _definition.pick(value[prop])
        })
      }
      if (this.extends) {
        utils.fillIn(copy, this.extends.pick(value))
      }
      // Conditionally copy properties not defined in "properties"
      if (this.additionalProperties) {
        for (var key in value) {
          if (!properties[key]) {
            copy[key] = utils.plainCopy(value[key])
          }
        }
      }
      return copy
    } else if (this.type === 'array') {
      return value.map((item) => {
        const _copy = this.items ? this.items.pick(item) : {}
        if (this.extends) {
          utils.fillIn(_copy, this.extends.pick(item))
        }
        return _copy
      })
    }
    return utils.plainCopy(value)
  },

  /**
   * Validate the provided value against this schema.
   *
   * @name Schema#validate
   * @method
   * @param {*} value Value to validate.
   * @param {object} [opts] Configuration options.
   * @returns {(array|undefined)} Array of errors or `undefined` if valid.
   */
  validate (value, opts) {
    return validate(value, this, opts)
  }
}, {
  ANY_OPS,
  ARRAY_OPS,
  NUMERIC_OPS,
  OBJECT_OPS,
  STRING_OPS,
  typeGroupValidators,
  types,
  validate,
  validationKeywords
})

/**
 * Create a subclass of this Schema:
 * @example &lt;caption>Schema.extend&lt;/caption>
 * const JSData = require('js-data');
 * const { Schema } = JSData;
 * console.log('Using JSData v' + JSData.version.full);
 *
 * // Extend the class using ES2015 class syntax.
 * class CustomSchemaClass extends Schema {
 *   foo () { return 'bar'; }
 *   static beep () { return 'boop'; }
 * }
 * const customSchema = new CustomSchemaClass();
 * console.log(customSchema.foo());
 * console.log(CustomSchemaClass.beep());
 *
 * // Extend the class using alternate method.
 * const OtherSchemaClass = Schema.extend({
 *   foo () { return 'bar'; }
 * }, {
 *   beep () { return 'boop'; }
 * });
 * const otherSchema = new OtherSchemaClass();
 * console.log(otherSchema.foo());
 * console.log(OtherSchemaClass.beep());
 *
 * // Extend the class, providing a custom constructor.
 * function AnotherSchemaClass () {
 *   Schema.call(this);
 *   this.created_at = new Date().getTime();
 * }
 * Schema.extend({
 *   constructor: AnotherSchemaClass,
 *   foo () { return 'bar'; }
 * }, {
 *   beep () { return 'boop'; }
 * });
 * const anotherSchema = new AnotherSchemaClass();
 * console.log(anotherSchema.created_at);
 * console.log(anotherSchema.foo());
 * console.log(AnotherSchemaClass.beep());
 *
 * @method Schema.extend
 * @param {object} [props={}] Properties to add to the prototype of the
 * subclass.
 * @param {object} [props.constructor] Provide a custom constructor function
 * to be used as the subclass itself.
 * @param {object} [classProps={}] Static properties to add to the subclass.
 * @returns {Constructor} Subclass of this Schema class.
 * @since 3.0.0
 */
</code></pre>
        </article>
    </section>






</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.3</a> on Sat Jan 25 2020 22:32:20 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
